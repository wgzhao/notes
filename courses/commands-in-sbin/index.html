
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="记录日常工作、学习的一些文档，收藏看到好的资源等">
      
      
        <meta name="author" content="wgzhao">
      
      
        <link rel="canonical" href="https://wgzhao.github.io/notes/courses/commands-in-sbin/">
      
      
        <link rel="prev" href="../../bigdata/zookeeper-optimize/">
      
      
        <link rel="next" href="../linux-cfs-scheduler/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS 订阅" href="../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="已更新内容的 RSS 订阅" href="../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.1">
    
    
      
        <title>Linux 命令学习 - 个人笔记</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#linux" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="个人笔记" class="md-header__button md-logo" aria-label="个人笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            个人笔记
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Linux 命令学习
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/wgzhao/notes" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    wgzhao/notes
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../tags/" class="md-tabs__link">
        
  
    
  
  Tags

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../bigdata/ambari-cli/" class="md-tabs__link">
          
  
    
  
  Bigdata

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
    
  
  Courses

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../database/maridb-ax-setup/" class="md-tabs__link">
          
  
    
  
  Database

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../kubernetes/access-k8s-pod-from-outersider/" class="md-tabs__link">
          
  
    
  
  Kubernetes

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../misc/Latex%20Math%20Symbols/" class="md-tabs__link">
          
  
    
  
  Misc

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../programming/design-restful-api-with-python-and-flask/" class="md-tabs__link">
          
  
    
  
  Programming

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tips/bash-tips/" class="md-tabs__link">
          
  
    
  
  Tips

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../troubleshooting/capture-http-requests-with-tcpdump/" class="md-tabs__link">
          
  
    
  
  Troubleshooting

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="个人笔记" class="md-nav__button md-logo" aria-label="个人笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    个人笔记
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/wgzhao/notes" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    wgzhao/notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bigdata
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Bigdata
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bigdata/ambari-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 Ambari API 来操作 Hadoop 集群
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bigdata/flink-cdc-practices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flink SQL CDC 实践以及一致性分析
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bigdata/integrating-hive-with-spark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrating Apache Hive with Apache Spark
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bigdata/integrating-phoenix-with-kerberos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phoenix 集成 HBase 并支持 Kerberos 认证
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bigdata/ipa-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    free IPA setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bigdata/kerberos-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MIT Kerberos  安装及维护手册
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bigdata/mafengwo-warehouse-design-and-practices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    马蜂窝数据仓库设计与实践
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bigdata/presto-with-ssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Presto SSL 配置
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bigdata/zookeeper-optimize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zookeeper集群应对万级并发的调优
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Courses
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Courses
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Linux 命令学习
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Linux 命令学习
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sbin-a" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下 a 开头的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin 下 a 开头的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accton" class="md-nav__link">
    <span class="md-ellipsis">
      accton
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adsl-" class="md-nav__link">
    <span class="md-ellipsis">
      adsl-*
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbin-b" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下 b 开始的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin 下 b 开始的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#badblocks" class="md-nav__link">
    <span class="md-ellipsis">
      badblocks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blkid" class="md-nav__link">
    <span class="md-ellipsis">
      blkid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blockdev" class="md-nav__link">
    <span class="md-ellipsis">
      blockdev
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbin-c" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下 c 开始的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin 下 c 开始的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#change_console" class="md-nav__link">
    <span class="md-ellipsis">
      change_console
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chkconfig" class="md-nav__link">
    <span class="md-ellipsis">
      chkconfig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consoletype" class="md-nav__link">
    <span class="md-ellipsis">
      consoletype
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cryptsetup" class="md-nav__link">
    <span class="md-ellipsis">
      cryptsetup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ctrlaltdel" class="md-nav__link">
    <span class="md-ellipsis">
      ctrlaltdel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbin-d" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下 d 开头的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin 下 d 开头的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugfs" class="md-nav__link">
    <span class="md-ellipsis">
      debugfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#depart" class="md-nav__link">
    <span class="md-ellipsis">
      depart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#depmod" class="md-nav__link">
    <span class="md-ellipsis">
      depmod
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhclient" class="md-nav__link">
    <span class="md-ellipsis">
      dhclient
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dmraid" class="md-nav__link">
    <span class="md-ellipsis">
      dmraid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dmsetup" class="md-nav__link">
    <span class="md-ellipsis">
      dmsetup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dosfsck" class="md-nav__link">
    <span class="md-ellipsis">
      dosfsck
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dump" class="md-nav__link">
    <span class="md-ellipsis">
      dump
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dump_cis" class="md-nav__link">
    <span class="md-ellipsis">
      dump_cis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dumpe2fs" class="md-nav__link">
    <span class="md-ellipsis">
      dumpe2fs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbin-e" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin/ 下 e 开头的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin/ 下 e 开头的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#e2fsck" class="md-nav__link">
    <span class="md-ellipsis">
      e2fsck
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e2image" class="md-nav__link">
    <span class="md-ellipsis">
      e2image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e2label" class="md-nav__link">
    <span class="md-ellipsis">
      e2label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elvtune" class="md-nav__link">
    <span class="md-ellipsis">
      elvtune
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ether-wake" class="md-nav__link">
    <span class="md-ellipsis">
      ether-wake
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethtool" class="md-nav__link">
    <span class="md-ellipsis">
      ethtool
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbin-f" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下 f 开头的命令如下
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin 下 f 开头的命令如下">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#findfs" class="md-nav__link">
    <span class="md-ellipsis">
      findfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixfiles" class="md-nav__link">
    <span class="md-ellipsis">
      fixfiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fuser" class="md-nav__link">
    <span class="md-ellipsis">
      fuser
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fxload" class="md-nav__link">
    <span class="md-ellipsis">
      fxload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbin-g" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下 g 开头的命令：
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin 下 g 开头的命令：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generate-modprobeconf" class="md-nav__link">
    <span class="md-ellipsis">
      generate-modprobe.conf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getkey" class="md-nav__link">
    <span class="md-ellipsis">
      getkey
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grub" class="md-nav__link">
    <span class="md-ellipsis">
      grub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#genhostid" class="md-nav__link">
    <span class="md-ellipsis">
      genhostid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getmd" class="md-nav__link">
    <span class="md-ellipsis">
      getmd
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbin-h" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下 h 开头的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin 下 h 开头的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#halt" class="md-nav__link">
    <span class="md-ellipsis">
      halt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hdparm" class="md-nav__link">
    <span class="md-ellipsis">
      hdparm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hotplug" class="md-nav__link">
    <span class="md-ellipsis">
      hotplug
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hwclock" class="md-nav__link">
    <span class="md-ellipsis">
      hwclock
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbin-l" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin/下 l 开头的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin/下 l 开头的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ldconfig" class="md-nav__link">
    <span class="md-ellipsis">
      ldconfig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lilo" class="md-nav__link">
    <span class="md-ellipsis">
      lilo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logsave" class="md-nav__link">
    <span class="md-ellipsis">
      logsave
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loopctrl" class="md-nav__link">
    <span class="md-ellipsis">
      loopctrl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsmod" class="md-nav__link">
    <span class="md-ellipsis">
      lsmod
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lspci" class="md-nav__link">
    <span class="md-ellipsis">
      lspci
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsusb" class="md-nav__link">
    <span class="md-ellipsis">
      lsusb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lvm" class="md-nav__link">
    <span class="md-ellipsis">
      lvm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbin-m" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 目录下 m 开头的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin 目录下 m 开头的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mdadm" class="md-nav__link">
    <span class="md-ellipsis">
      mdadm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mdmpd" class="md-nav__link">
    <span class="md-ellipsis">
      mdmpd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mii-tool" class="md-nav__link">
    <span class="md-ellipsis">
      mii-tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkbootdisk" class="md-nav__link">
    <span class="md-ellipsis">
      mkbootdisk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkfs" class="md-nav__link">
    <span class="md-ellipsis">
      mkfs.*：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mkinitrd" class="md-nav__link">
    <span class="md-ellipsis">
      mkinitrd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modinfo" class="md-nav__link">
    <span class="md-ellipsis">
      modinfo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mount" class="md-nav__link">
    <span class="md-ellipsis">
      mount.*
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbin-n" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下 n 开头的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin 下 n 开头的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nameif" class="md-nav__link">
    <span class="md-ellipsis">
      nameif
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nash" class="md-nav__link">
    <span class="md-ellipsis">
      nash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netplugd" class="md-nav__link">
    <span class="md-ellipsis">
      netplugd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-kernel-pkg" class="md-nav__link">
    <span class="md-ellipsis">
      new-kernel-pkg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nolog" class="md-nav__link">
    <span class="md-ellipsis">
      nolog
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sbinp" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin/p 开头的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/sbin/p 开头的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pack_cis" class="md-nav__link">
    <span class="md-ellipsis">
      pack_cis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pam_cosonle_apply" class="md-nav__link">
    <span class="md-ellipsis">
      pam_cosonle_apply
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pam_console_setowner" class="md-nav__link">
    <span class="md-ellipsis">
      pam_console_setowner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parted" class="md-nav__link">
    <span class="md-ellipsis">
      parted
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partx" class="md-nav__link">
    <span class="md-ellipsis">
      partx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pivot_root" class="md-nav__link">
    <span class="md-ellipsis">
      pivot_root
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#portmap" class="md-nav__link">
    <span class="md-ellipsis">
      portmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sbin-q" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下的 q 开头的命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sbin-r" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下 r 开头的命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restore" class="md-nav__link">
    <span class="md-ellipsis">
      restore
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sfdisk" class="md-nav__link">
    <span class="md-ellipsis">
      sfdisk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sbin" class="md-nav__link">
    <span class="md-ellipsis">
      /sbin 下剩余的命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tune2fs" class="md-nav__link">
    <span class="md-ellipsis">
      tune2fs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usrsbin" class="md-nav__link">
    <span class="md-ellipsis">
      /usr/sbin 下的命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/usr/sbin 下的命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alternatives" class="md-nav__link">
    <span class="md-ellipsis">
      alternatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#am-eject" class="md-nav__link">
    <span class="md-ellipsis">
      am-eject
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anaconda" class="md-nav__link">
    <span class="md-ellipsis">
      anaconda
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anacron" class="md-nav__link">
    <span class="md-ellipsis">
      anacron
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgpd" class="md-nav__link">
    <span class="md-ellipsis">
      bgpd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bmc-config" class="md-nav__link">
    <span class="md-ellipsis">
      bmc-config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brctl" class="md-nav__link">
    <span class="md-ellipsis">
      brctl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chroot" class="md-nav__link">
    <span class="md-ellipsis">
      chroot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chpasswd" class="md-nav__link">
    <span class="md-ellipsis">
      chpasswd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhcrelay" class="md-nav__link">
    <span class="md-ellipsis">
      dhcrelay
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dovecot" class="md-nav__link">
    <span class="md-ellipsis">
      dovecot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dump-acct" class="md-nav__link">
    <span class="md-ellipsis">
      dump-acct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dump-utmp" class="md-nav__link">
    <span class="md-ellipsis">
      dump-utmp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dumpcap" class="md-nav__link">
    <span class="md-ellipsis">
      dumpcap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filefrag" class="md-nav__link">
    <span class="md-ellipsis">
      filefrag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wireshark" class="md-nav__link">
    <span class="md-ellipsis">
      wireshark
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tripwire" class="md-nav__link">
    <span class="md-ellipsis">
      tripwire
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vipw" class="md-nav__link">
    <span class="md-ellipsis">
      vipw
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux-cfs-scheduler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux CFS 调度器：原理、设计与内核实现
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pg9_high_performance_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    《PostgreSQL 9 High Performance》读书笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Mysql lecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Mysql lecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-lecture/mysql-practices-lecture-45-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    《MySQL 实战45讲》节选第一部分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-lecture/mysql-practices-lecture-45-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    《MySQL 实战45讲》节选第二部分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-lecture/mysql-practices-lecture-45-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    《MySQL 实战45讲》节选第三部分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-lecture/mysql-practices-lecture-45-4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    《MySQL 实战45讲》节选第四部分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-lecture/mysql-practices-lecture-45-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    《MySQL 实战45讲》节选第五部分
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Time series analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Time series analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time-series-analysis/01-basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    基础篇
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time-series-analysis/02-primer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    初级篇
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time-series-analysis/03-advance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    进阶篇
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time-series-analysis/04-practices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    应用篇
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time-series-analysis/05-complete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    补完篇
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Database
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Database
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database/maridb-ax-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MariaDB AX 安装测试简记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database/mysql-cluster-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MySQL Cluster 配置
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database/oracle-11g-imp-and-exp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Oracle 11g 导入导出基本操作
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database/oracle-silent-installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Oracle 静默安装
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database/percona-cluster-with-haproxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HAProxy + Percona XtraDB Cluster 部署
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database/setup-a-clickhouse-cluster-on-one-node/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    在一个节点上部署 ClickHouse 集群
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database/why-mysql8-slower-than-mysql57/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    默认配置下，为什么 MySQL 8.0 比 MySQL 5.7 慢
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/access-k8s-pod-from-outersider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    外部机器如何直接直接访问 kubernetes 集群内服务
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/calico-node-troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calico Node 无法启动的排查
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/collect-k8s-log-with-filebeat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    基于 ELK 的 日志收集与自动索引创建
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/coredns-support-hosts-file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CoreDNS 支持解析宿主机的 hosts 文件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/deep-dive-into-k8s-internals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    用奇怪的方式构建简单 k8s 集群
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/how-to-create-user-for-k8s-dashboard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    在 Kubernetes Dashboard 创建基于 RBAC 的授权用户
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/kubernetes-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 kubeadm 安装 kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubernetes/take-flannel-to-calico/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migrate kubernetes cluster from Flannel to Calico
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/Latex%20Math%20Symbols/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    用于 LateX 的数学符号
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/git-from-zero-to-hero/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git从入门到应付日常工作
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/gitlab-ci-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gitlab-ci.yml 详解
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/osint-introduce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    超级情报手机工具库：开源验证和调查工具及使用方法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programming
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/design-restful-api-with-python-and-flask/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用 Python 和 Flask 设计 RESTful API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/programming-with-vim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    无插件Vim编程技巧
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/pure-bash-bible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pure Bash Bible
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/understanding-awk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understanding AWK
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tips
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/bash-tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BASH 的一些技巧
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/batch-convert-word-to-pdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows 下批量转换 word 文档为 pdf 的方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/change-keyboard-layout-in-ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu 下修改键盘映射
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/git-internals-objects-branches-create-repo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git 内部原理图解 -- 对象、分支以及如何从零开始建仓库
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/git-tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git 不常见的操作技巧
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/how-to-create-dummy-rpm-package/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    快速创建一个虚假 RPM 包
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/howto-change-git-author/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to change git author name and email
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/howto-delete-old-images-from-nexus-registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何删除 nexus 私服上的 Docker 镜像
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/howto-save-tmux-session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to save tmux session
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/learn-seaborn-with-10min/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    十分钟掌握 Seaborn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/matplotlib-support-chinese/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    让 Python 中 matplotlib 图支持中文
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/move-running-process-into-tmux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    把一个运行的进程放到 tmux 会话中
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/rpm-tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rpm 包管理基本技能
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/sed-one-line-tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SED 单行脚本快速参考
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/setup-gitlab-ci-for-android/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup Gitlab CI For Android
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/ssh-three-key-features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ssh的三板斧
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/ssh-tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSH examples, tips and tunnels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tips/wechat-contacts-backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    微信通讯录备份
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/capture-http-requests-with-tcpdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TCPDump Capture HTTP GET/POST requests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/deep-in-tcp-connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    详解 TCP 半连接队列与全连接队列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/docker-run-no-space-left/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker 运行容器报磁盘空间不足的错误
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/fix-ora-00227/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    修复 Oracle ORA-00227 错误
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/jdk1.6-support-tlsv1.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    让 Oracle JDK 1.6 TLSv1.2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
        <a href="../../tags/#tag:commands" class="md-tag">commands</a>
      
    
      
      
      
        <a href="../../tags/#tag:linux" class="md-tag">linux</a>
      
    
  </nav>



<h1 id="linux">Linux 命令学习<a class="headerlink" href="#linux" title="Permanent link">&para;</a></h1>
<p>这其实很早很早前我在自己博客上贴的内容了，是我 2007 年 1 月开始到当年 7 月，半年多的时间系统学习 Linux 下 <code>/sbin</code> 以及 <code>/usr/sbin/</code> 的每个命令，这个的缘起还是之前在 2007 年的时候，苦于自己对 Linux 深入学习进入了一个瓶颈，不知道从那个方面可以入手，于是去请教当时公司的 Linux 内核研发经理，应该从哪里方面入手，他回答说，他之前在 Linux 伊甸园（知道这个论坛的估计年级都不小了）上名为 <code>nntp</code> 的版主说，一个优秀的 Linux 系统管理员，都应该认真学习<code>/sbin/</code> <code>/usr/sbin</code> 下的所有命令，你可以从这里入手。</p>
<p>之前是分类记录的，现在我把他整理在一块，这些命令还是基于 RedHat Enterprise 5.0 ，已经很古老了，不过很多命令也很久没有更新了，所以用法一直保留了下来。</p>
<h2 id="sbin-a">/sbin 下 a 开头的命令<a class="headerlink" href="#sbin-a" title="Permanent link">&para;</a></h2>
<p><code>/sbin</code> 下 a 开头的命令并不多，大概是这些</p>
<blockquote>
<p>accton adsl-setup adsl-stop arping auditd
addpart adsl-start agetty asianux-support-check
adsl-connect adsl-status arp auditctl</p>
</blockquote>
<p>其中 adsl 开头的命令占了一半。</p>
<p>分别简单介绍：</p>
<h3 id="accton">accton<a class="headerlink" href="#accton" title="Permanent link">&para;</a></h3>
<p>打开或者关闭进程统计（account)，如果不加任何参数，缺省的情况下是关闭进程统计。</p>
<p>要理解这个命令，就需要看看其他几个命令了。
首先我们看看 accton 属于哪个包</p>
<div class="highlight"><pre><span></span><code><span class="c1"># rpm -qf accton</span>
psacct-6.3.2-35.rhel4
<span class="c1"># rpm -qi psacct</span>
....
Description<span class="w"> </span>:
The<span class="w"> </span>psacct<span class="w"> </span>package<span class="w"> </span>contains<span class="w"> </span>several<span class="w"> </span>utilities<span class="w"> </span><span class="k">for</span><span class="w"> </span>monitoring<span class="w"> </span>process
activities,<span class="w"> </span>including<span class="w"> </span>ac,<span class="w"> </span>lastcomm,<span class="w"> </span>accton<span class="w"> </span>and<span class="w"> </span>sa.<span class="w"> </span>The<span class="w"> </span>ac<span class="w"> </span><span class="nb">command</span>
displays<span class="w"> </span>statistics<span class="w"> </span>about<span class="w"> </span>how<span class="w"> </span>long<span class="w"> </span>users<span class="w"> </span>have<span class="w"> </span>been<span class="w"> </span>logged<span class="w"> </span>on.<span class="w"> </span>The
lastcomm<span class="w"> </span><span class="nb">command</span><span class="w"> </span>displays<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>previous<span class="w"> </span>executed
commands.<span class="w"> </span>The<span class="w"> </span>accton<span class="w"> </span><span class="nb">command</span><span class="w"> </span>turns<span class="w"> </span>process<span class="w"> </span>accounting<span class="w"> </span>on<span class="w"> </span>or<span class="w"> </span>off.<span class="w"> </span>The
sa<span class="w"> </span><span class="nb">command</span><span class="w"> </span>summarizes<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>previously<span class="w"> </span>executed
commmands.
</code></pre></div>
<p>从这个描述来看，我们知道 accton 以及 ac,lastcomm,sa 都是用来监控进程的活动性的。</p>
<p>其中 ac 命令显示某个用户已经登录多久了（单位是小时），比如</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ac root</span>

total<span class="w"> </span><span class="m">9</span>.13

<span class="c1"># ac mlsx</span>

total<span class="w"> </span><span class="m">0</span>.00
<span class="c1"># ac -d</span>
Jan<span class="w"> </span><span class="m">11</span><span class="w"> </span>total<span class="w"> </span><span class="m">0</span>.98
Jan<span class="w"> </span><span class="m">12</span><span class="w"> </span>total<span class="w"> </span><span class="m">0</span>.49
Jan<span class="w"> </span><span class="m">13</span><span class="w"> </span>total<span class="w"> </span><span class="m">1</span>.79
Jan<span class="w"> </span><span class="m">15</span><span class="w"> </span>total<span class="w"> </span><span class="m">3</span>.97
Jan<span class="w"> </span><span class="m">16</span><span class="w"> </span>total<span class="w"> </span><span class="m">0</span>.03
Jan<span class="w"> </span><span class="m">22</span><span class="w"> </span>total<span class="w"> </span><span class="m">1</span>.60
Today<span class="w"> </span>total<span class="w"> </span><span class="m">0</span>.54

<span class="c1"># ac –-reboots</span>
total<span class="w"> </span><span class="m">28</span>.81
</code></pre></div>
<p>ac 可以接受的参数的并不是很多，而且也比较容易理解。只是这个 <code>reboots</code> 我有点不好理解他，暂时我的理解是本次进入系统于上次进入系统的时间差（小时），也就是最近两次进入系统的时间间隔。
而 <code>lastcomm</code> 则显示之前执行的那些命令的信息。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># lastcomm | head</span>
lastcomm<span class="w"> </span>S<span class="w"> </span>X<span class="w"> </span>root<span class="w"> </span>pts/0<span class="w"> </span><span class="m">0</span>.29<span class="w"> </span>secs<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">21</span>:38
scim-helper-lau<span class="w"> </span>SF<span class="w"> </span>root<span class="w"> </span>__<span class="w"> </span><span class="m">4</span>.26<span class="w"> </span>secs<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">21</span>:37
scim-helper-lau<span class="w"> </span>S<span class="w"> </span>root<span class="w"> </span>__<span class="w"> </span><span class="m">0</span>.01<span class="w"> </span>secs<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">21</span>:37
ac<span class="w"> </span>S<span class="w"> </span>root<span class="w"> </span>pts/1<span class="w"> </span><span class="m">0</span>.00<span class="w"> </span>secs<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">21</span>:35
ac<span class="w"> </span>S<span class="w"> </span>root<span class="w"> </span>pts/1<span class="w"> </span><span class="m">0</span>.00<span class="w"> </span>secs<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">21</span>:35
ac<span class="w"> </span>S<span class="w"> </span>root<span class="w"> </span>pts/1<span class="w"> </span><span class="m">0</span>.00<span class="w"> </span>secs<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">21</span>:35
ac<span class="w"> </span>S<span class="w"> </span>root<span class="w"> </span>pts/1<span class="w"> </span><span class="m">0</span>.00<span class="w"> </span>secs<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">21</span>:35
crond<span class="w"> </span>SF<span class="w"> </span>root<span class="w"> </span>__<span class="w"> </span><span class="m">0</span>.00<span class="w"> </span>secs<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">21</span>:35
mrtg<span class="w"> </span>S<span class="w"> </span>root<span class="w"> </span>__<span class="w"> </span><span class="m">0</span>.83<span class="w"> </span>secs<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">21</span>:35
ac<span class="w"> </span>S<span class="w"> </span>root<span class="w"> </span>pts/1<span class="w"> </span><span class="m">0</span>.00<span class="w"> </span>secs<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">21</span>:34
</code></pre></div>
<p>这里些列分别表示命令的名称，标识，执行帐号，执行终端，已经程序退出的时间。
其中表示的定义如下：</p>
<ul>
<li>S: 该命令由超级用户执行。</li>
<li>F: 命令是在 fork 后执行的，但是接下来没有执行 exec</li>
<li>C: 命令运行在 PDP－11 兼容模式下（这个向下兼容也太长时间了吧）</li>
<li>D: 命令中断，且产生了 core 文件。</li>
<li>X: 命令受到 SIGTERM 信号而中断</li>
</ul>
<p>而上面的这些信息是否存在就看 accton 的命令操作了，如果他关闭进程信息统计，那么这些命令就无法得到上述信息。
出了运行 accton 命令外，也使用使用</p>
<p><code>/etc/init.d/psacct [start|stop]</code></p>
<p>开启或者停止进程信息统计。</p>
<h3 id="adsl-">adsl-*<a class="headerlink" href="#adsl-" title="Permanent link">&para;</a></h3>
<p>这些命令一看就知道是与 ADSL 有关的。</p>
<p><code>adsl-setup</code> 用来设置对应的信息，采用交互模式，非常的傻瓜化。</p>
<p><code>adsl-connect</code> 是管理一个 PPPoE 连接的命令。</p>
<p><code>adsl-start</code> 开始拨号
<code>adsl-stop</code> 断开
<code>adsl-status</code> 查看状态</p>
<p>这里 ADSL 的设置和 windows 下有一个小的区别，那就是 windows 是自动获取 DNS 的，但是在 Linux 却不是这样，因此你要先填写 DNS 地址才能正常上网。</p>
<p><code>agetty</code> alternative Linux getty，一个 Linux 下 getty 程序的替换者。一般不手工执行。</p>
<p><code>arp</code>,<code>arping</code> 与 ARP 相关的命令，可以清空 ARP 表，刷新 ARP 表，这个程序在高可用的环境下可以得到重用。</p>
<p><code>auditctl</code>,<code>auditd</code> 审计程序，按照 RPM 包的说明，他们的主要用处是存储和处理有内核审计子系统产生的审计记录。</p>
<h2 id="sbin-b">/sbin 下 b 开始的命令<a class="headerlink" href="#sbin-b" title="Permanent link">&para;</a></h2>
<h3 id="badblocks">badblocks<a class="headerlink" href="#badblocks" title="Permanent link">&para;</a></h3>
<p>对指定的设备找出坏块,他接受的参数不是太多，你可以指定开始块也结束块。还能用 <code>-f</code> 来指定是否需要对查找的分区进行修复，不过在 man 中对 <code>-f</code> 这个参数的描述是，
永远都不要使用 <code>-f</code>，除非你比这个命令更聪明。</p>
<div class="highlight"><pre><span></span><code><span class="o">]</span><span class="c1"># badblocks /dev/hda5</span>
</code></pre></div>
<p>man 手册中提到一般不要直接执行 badblocks 命令，而是应该用 <code>e2fsck</code> 命令的 <code>－c</code> 参数来自动调用 <code>badblocks</code> 命令，他会查找坏块并标记起来，以便下次存储数据时，不会存储在这些坏块上。</p>
<h3 id="blkid">blkid<a class="headerlink" href="#blkid" title="Permanent link">&para;</a></h3>
<p>用来定位或者打印块设备属性的命令行工具，他一般和 libuuid(3) 程序库一起使用。他可以推测出一个块设备内容的类型（比如是文件系统，是 swap）和其他属性。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># blkid /dev/hda5</span>
<span class="w">     </span>/dev/hda5:<span class="w"> </span><span class="nv">LABEL</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="w"> </span><span class="nv">UUID</span><span class="o">=</span><span class="s2">&quot;74e3bf86-ce24-411d-ac35-c4bc49964f36&quot;</span><span class="w"> </span><span class="nv">SEC_TYPE</span><span class="o">=</span><span class="s2">&quot;ext3&quot;</span><span class="w"> </span><span class="nv">TYPE</span><span class="o">=</span><span class="s2">&quot;ext2&quot;</span>
<span class="c1"># blkid /dev/hda1 /dev/hda1: UUID=&quot;6C2B-F039&quot; TYPE=&quot;vfat&quot;</span>
</code></pre></div>
<p>UUID 在 RAID 和 LVM 中有比较广泛的使用，在 RAID 中，寻找某一个设备或者分区不是根据你的设备号（比如 hda3），也不是标签（比如 <code>/HOME</code>)，因为手工创建的分区默认没有标签，而是根据 UUID 号，比如你的第一个 SCSI 设备因为槽位的变化，那么在 linux 中设备好也发生了变化（比如从 sda 变成 sdb)，但是系统依然能够识别出来。</p>
<p>而槽位的改变在服务器上很容易发生，因为大部分都是支持热插拔的。在 LVM 的配置文件中，你更能非常清楚的看到 UUID 号。</p>
<h3 id="blockdev">blockdev<a class="headerlink" href="#blockdev" title="Permanent link">&para;</a></h3>
<p>在命令行调用设备的 <code>ioctl</code> 函数。在 Linux 系统中，似乎对设备的直接操作只有 <code>ioctl</code> 函数了。他接受的参数不是太多，而且都是一一对应的。</p>
<div class="highlight"><pre><span></span><code>--setro<span class="w"> </span>设置设备为只读
--getro<span class="w"> </span>读取设备是否为只读（成功为<span class="w"> </span><span class="m">1</span>，0<span class="w"> </span>则为可读写）
--setrw<span class="w"> </span>设置设别为可读写
--getss<span class="w"> </span>打印设备的扇区大小，通常是<span class="w"> </span><span class="m">512</span>
--getsize<span class="w"> </span>打印设别的容量，按照一个扇区<span class="w"> </span><span class="m">512</span><span class="w"> </span>个字节计算
--setra<span class="w"> </span>N<span class="w"> </span>Set<span class="w"> </span>readahead<span class="w"> </span>to<span class="w"> </span>N<span class="w"> </span><span class="m">512</span>-byte<span class="w"> </span>sectors.
--getra<span class="w"> </span>打印<span class="w"> </span>readahead
--flushbufs<span class="w"> </span>刷新缓冲
--rereadpt<span class="w"> </span>重读分区表。
</code></pre></div>
<p>个人觉得 <code>--setro</code>, <code>--setrw</code> 比较有用，这个 <code>mount -o ro(rw)</code>是有区别的，mount 是在文件系统这个级别上对某个分区挂载为只读或可读写。</p>
<p>而 blockdev 则是在设别这个级别上设置为只读和可读写。</p>
<p>看下面的命令输出结果就一目了然了。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># blockdev –setro /dev/hda4</span>
<span class="c1"># blockdev –getro /dev/hda4</span>
<span class="w">    </span><span class="m">1</span>
<span class="c1"># mount /dev/hda4 /misc -o rw</span>
<span class="w">    </span>mount:<span class="w"> </span>block<span class="w"> </span>device<span class="w"> </span>/dev/hda4<span class="w"> </span>is<span class="w"> </span>write-protected,<span class="w"> </span>mounting<span class="w"> </span>read-only
<span class="c1"># umount /dev/hda4</span>
<span class="c1"># blockdev –setrw /dev/hda4</span>
<span class="c1"># blockdev –getro /dev/hda4</span>
<span class="w">    </span><span class="m">0</span>
<span class="c1"># mount /dev/hda4 /misc -o rw</span>
<span class="c1"># touch /misc/one</span>
<span class="c1"># umount /dev/hda4</span>
<span class="c1"># mount /dev/hda4 /misc -o ro</span>
<span class="c1"># rm -f /misc/one</span>
<span class="w">    </span>rm:<span class="w"> </span>无法删除‘/misc/one’:<span class="w"> </span>只读文件系统
</code></pre></div>
<p>这个命令在高可用环境比较实用。比如红旗的 HA 产品就使用了类似的命令来防止，红旗 HA 停止时，会自动将他监管的设备设置为只读，防止用户的改写，除非你手工设置为可读写（红旗 HA 使用了 <code>clproset</code> 命令，其作用应该和这个差不多）</p>
<h2 id="sbin-c">/sbin 下 c 开始的命令<a class="headerlink" href="#sbin-c" title="Permanent link">&para;</a></h2>
<p>/sbin 目录下 c 开头的命令也没有多少，列出如下</p>
<blockquote>
<p>cardctl cardmgr change_console chkconfig clock consoletype cryptsetup ctrlaltdel</p>
</blockquote>
<p>其中 <code>clock</code> 还是软连接。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ls -l clock</span>
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">7</span><span class="w"> </span>9月<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">12</span>:07<span class="w"> </span>clock<span class="w"> </span>-&gt;<span class="w"> </span>hwclock
</code></pre></div>
<p><code>cardctl</code> 和 <code>cardmgr</code> 是对 PCMCIA 设备的操作，不过似乎直接使用这两个命令来管理 PCMCIA 设别的机会应该很少。一来 PCMCIA 插槽只在笔记本上有，二来目前 Linux 下能支持的 PCMCIA 设备还真不多，似乎除了一些无线网卡和很少的无线上网卡支持外，其他的我就不清楚了，所以这两个命令我没用过，看了 man 手册，也没有看出名堂，忽略之。</p>
<h3 id="change_console">change_console<a class="headerlink" href="#change_console" title="Permanent link">&para;</a></h3>
<p>改变终端，这个命令是 init 来用的，我怎么加参数来执行，也没有看出什么变化，man 手册说的很少，忽略之。</p>
<h3 id="chkconfig">chkconfig<a class="headerlink" href="#chkconfig" title="Permanent link">&para;</a></h3>
<p>更新和查询系统服务的运行级别信息。我们知道大部分的 Linux 发行版本都有 0-6 共 7 个级别的运行模式，先抛开关机的 0 级别和重启的 6 级别，那么就还有 1－5 共 5 个运行级别，Linux 系统允许你定义在不动的运行级别默认启动不动的系统服务。</p>
<p>而实际上所有的执行脚本都是在<code>/etc/rc.d/init.d/</code>下面。</p>
<p>而每个不同级别的可以运行的系统服务定义在<code>/etc/rc.d/rc[0-6].d</code>里，里面只有软连接。软连接分成了两种类型，一种是 K 开始的软连接，一种是 S 开头的软连接。分别表示需要停止的服务和启动的服务。</p>
<p>其中启动顺序有连接名中的数字决定，数字越小，启动的优先级就越高。</p>
<p>很显然如果要我们手工来管理这些连接，恐怕表示一件容易的事情。也是 <code>chkconfig</code> 就出现了。</p>
<p>目前 Linux 下的 <code>chkconfig</code> 主要完成 5 个方面的功能：</p>
<ol>
<li>增加可以管理的系统服务</li>
<li>移走可以管理的系统服务</li>
<li>列出当前服务器的启动信息</li>
<li>改变系统服务的启动信息</li>
<li>检查特定服务的启动状态</li>
</ol>
<p>我们举一个例子阐述上面的 5 个功能</p>
<p>假设我们写了一个服务程序，我们希望像其他系统服务那样可以定义不同级别的启动停止方式，而不是简单的加入到 <code>/etc/rc.d/rc.local</code> 文件中。那么我们首先要创建一个运行脚本放到 <code>/etc/rc.d/init.d</code> 目录下，并设置好权限。如果你不知道如何修改，那么你可以考参 <code>init.d</code> 目录下的任何一个运行脚本。下面的是我的一个最简单的脚本</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cat /etc/rc.d/init.d/test</span>
<span class="c1">#! /bin/sh</span>
<span class="c1">#</span>
<span class="c1"># test simple test system service for management by chkconfig</span>
<span class="c1">#</span>

<span class="c1"># Source function library.</span>
.<span class="w"> </span>/etc/rc.d/init.d/functions

<span class="c1"># Set defaults</span>

start<span class="o">(){</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>“Starting<span class="w"> </span>test:<span class="w"> </span>”
<span class="w">    </span>/usr/local/bin/tmy<span class="w"> </span>start
<span class="w">    </span><span class="nv">RETAL</span><span class="o">=</span><span class="nv">$?</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="o">}</span>

stop<span class="o">(){</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>“Stopping<span class="w"> </span>test:<span class="w"> </span>”
<span class="w">    </span>/usr/local/bin/tmy<span class="w"> </span>stop
<span class="w">    </span><span class="nv">RETVAL</span><span class="o">=</span><span class="nv">$?</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="o">}</span>

restart<span class="o">(){</span>
<span class="w">    </span>stop
<span class="w">    </span>start
<span class="o">}</span>

<span class="c1"># See how we were called.</span>
<span class="k">case</span><span class="w"> </span>“<span class="nv">$1</span>″<span class="w"> </span><span class="k">in</span>
<span class="w">    </span>start<span class="o">)</span>
<span class="w">    </span>start
<span class="w">    </span><span class="p">;;</span>
<span class="w">    </span>stop<span class="o">)</span>
<span class="w">    </span>stop
<span class="w">    </span><span class="p">;;</span>
*<span class="o">)</span>
<span class="nb">echo</span><span class="w"> </span>“Usage:<span class="w"> </span><span class="nb">test</span><span class="w"> </span><span class="o">{</span>start<span class="p">|</span>stop<span class="p">|</span><span class="o">}</span>”
<span class="nv">RETVAL</span><span class="o">=</span><span class="m">1</span>
<span class="k">esac</span>

<span class="nb">exit</span><span class="w"> </span><span class="nv">$RETVAL</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># cat /usr/local/bin/tmy</span>
<span class="c1">#!/bin/bash</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>“start”<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="k">then</span>
<span class="nb">echo</span><span class="w"> </span>“have<span class="w"> </span>started<span class="w"> </span>my<span class="w"> </span>services”
<span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>“stop”<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="nb">echo</span><span class="w"> </span>“have<span class="w"> </span>stoped<span class="w"> </span>myservices”
<span class="k">fi</span>
<span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
</code></pre></div>
<p>现在你可以使用<code>/etc/init.d/test start|stop</code>的方式启动这个服务。但是</p>
<p><code>chkconfig --list test test</code> 服务不支持 chkconfig</p>
<p>所以，接下来我们要把这个服务器加入到可管理系统服务中，我们需要在执行脚本中加入两行让 chkconfig 识别的注释</p>
<div class="highlight"><pre><span></span><code><span class="c1"># chkconfig:2345 20 80</span>
<span class="c1"># description: test simple test system service for management by chkconfig</span>
</code></pre></div>
<p>这两行注释是告诉 <code>chkconfig</code> 命令，这脚本应该在 2，3，4，5 这 4 个级别启动，且启动优先级是 20，而对应的停止优先级是 80。
加入后，我们再试试 chkconfig 命令</p>
<div class="highlight"><pre><span></span><code><span class="c1"># chkconfig --list test</span>
<span class="nb">test</span><span class="w"> </span>服务支持<span class="w"> </span>chkconfig，但它在任何级别中都没有被引用<span class="o">(</span>运行“chkconfig<span class="w"> </span>--add<span class="w"> </span>test”<span class="o">)</span>
</code></pre></div>
<p>恩，至少 chkconfig 认识出了 test，而且也说了可以被管理，只是没有加入。</p>
<p>根据提示，我们需要加入他</p>
<div class="highlight"><pre><span></span><code><span class="c1"># chkconfig --add test</span>
<span class="c1"># echo $?</span>
<span class="m">0</span>
<span class="c1"># chkconfig --list test test</span>
<span class="w">    </span><span class="m">0</span>:关闭<span class="w"> </span><span class="m">1</span>:关闭<span class="w"> </span><span class="m">2</span>:启用<span class="w"> </span><span class="m">3</span>:启用<span class="w"> </span><span class="m">4</span>:启用<span class="w"> </span><span class="m">5</span>:启用<span class="w"> </span><span class="m">6</span>:关闭
</code></pre></div>
<p>这和我们期望的是一样的。然后我们看看 test 软连接</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ls -l /etc/rc.d/rc6.d/K80test</span>
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">14</span><span class="w"> </span>1月<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">20</span>:47<span class="w"> </span>/etc/rc.d/rc6.d/K80test<span class="w"> </span>-&gt;<span class="w"> </span>../init.d/test
<span class="c1"># ls -l /etc/rc.d/rc3.d/S20test</span>
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">14</span><span class="w"> </span>1月<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">20</span>:47<span class="w"> </span>/etc/rc.d/rc3.d/S20test<span class="w"> </span>-&gt;<span class="w"> </span>../init.d/test
</code></pre></div>
<p>到此，test 服务已经加入了可被 chkconfig 管理的系统服务范围内。那么我们事实修改和删除看看。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># chkconfig --list test test</span>
<span class="m">0</span>:关闭<span class="w"> </span><span class="m">1</span>:关闭<span class="w"> </span><span class="m">2</span>:启用<span class="w"> </span><span class="m">3</span>:启用
<span class="m">4</span>:启用<span class="w"> </span><span class="m">5</span>:启用<span class="w"> </span><span class="m">6</span>:关闭
<span class="c1"># chkconfig --level 3 test off</span>
<span class="c1"># chkconfig --list test test</span>
<span class="m">0</span>:关闭<span class="w"> </span><span class="m">1</span>:关闭<span class="w"> </span><span class="m">2</span>:启用<span class="w"> </span><span class="m">3</span>:关闭<span class="w">     </span><span class="m">4</span>:启用<span class="w"> </span><span class="m">5</span>:启用<span class="w"> </span><span class="m">6</span>:关闭
<span class="c1"># ls -l /etc/rc.d/rc3.d/K80test</span>
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">14</span><span class="w"> </span>1月<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">20</span>:54<span class="w"> </span>/etc/rc.d/rc3.d/K80test<span class="w"> </span>-&gt;<span class="w">    </span>../init.d/test
<span class="c1"># chkconfig --del test</span>
<span class="c1"># chkconfig --list test</span>
<span class="nb">test</span><span class="w"> </span>服务支持<span class="w"> </span>chkconfig，但它在任何级别中都没有被引用<span class="o">(</span>运行“chkconfig<span class="w"> </span>--add<span class="w"> </span>test”<span class="o">)</span>
</code></pre></div>
<p>如果要彻底删除 test 服务，那么就只要删除 test 执行脚本就行了。</p>
<h3 id="consoletype">consoletype<a class="headerlink" href="#consoletype" title="Permanent link">&para;</a></h3>
<p>打印连接到标注输入的终端类型；这是 Asianux 特有的命令，他根据终端的不同类型打印出不同的信息。</p>
<p>如果是虚拟终端(/dev/tty* 或者不是串行终端的<code>/dev/console</code>)，打印出 vt</p>
<p>如果标准输入是串行终端(<code>/dev/console</code> 和或者<code>/dev/ttyS*</code>)，打印 serial</p>
<p>如果标准输入是伪终端（<code>/dev/pts/\*</code>)，打印 pty</p>
<div class="highlight"><pre><span></span><code><span class="c1"># who</span>
root<span class="w"> </span>pts/0<span class="w"> </span>Jan<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">19</span>:41<span class="w"> </span><span class="o">(</span>:0.0<span class="o">)</span>

<span class="c1"># consoletype</span>
pty

<span class="c1"># who</span>
root<span class="w"> </span>tty1<span class="w"> </span>Jan<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">21</span>:05

<span class="c1"># consoletype</span>
vt

<span class="c1"># cat test.c</span>
<span class="c1">#include</span>
<span class="c1">#include</span>
int<span class="w"> </span>main<span class="o">()</span>
<span class="o">{</span>
<span class="w">    </span>int<span class="w"> </span>fd1,fd2<span class="p">;</span>
<span class="w">    </span><span class="nv">fd1</span><span class="o">=</span>open<span class="o">(</span>“test.sh”,O_RDONLY<span class="o">)</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>!fd1<span class="o">)</span>
<span class="w">    </span><span class="o">{</span>
<span class="w">    </span>perror<span class="o">(</span>“error<span class="w"> </span>open<span class="w"> </span>test.sh”<span class="o">)</span><span class="p">;</span>
<span class="w">    </span>exit<span class="o">(</span><span class="m">65</span><span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
<span class="nv">fd2</span><span class="o">=</span>dup2<span class="o">(</span>fd1,0<span class="o">)</span><span class="p">;</span>
system<span class="o">(</span>“/sbin/consoletype<span class="w"> </span>&gt;/tmp/a”<span class="o">)</span><span class="p">;</span>
<span class="k">return</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="o">}</span>
<span class="c1"># gcc test.c -o test</span>
<span class="c1"># ./test</span>
<span class="c1"># cat a</span>
serial
<span class="c1"># consoletype</span>
pty
</code></pre></div>
<h3 id="cryptsetup">cryptsetup<a class="headerlink" href="#cryptsetup" title="Permanent link">&para;</a></h3>
<p>对指定的设别进行加密，这里的设别必须是 <code>/dev/mapper</code> 下的设备，那这样看来 2.4 的内核是没有这个命令了。
他对应的应该有另外一个命令 <code>dm-crypt</code>，但是我的系统上找不到。
该命令没有 man 手册，其 help 帮助如下：</p>
<div class="highlight"><pre><span></span><code># cryptsetup –help
Usage: cryptsetup [OPTION…] []
-v, –verbose Shows more detailed error messages
-c, –cipher=STRING The cipher used to encrypt the disk (see
/proc/crypto) (default: “aes”)
-h, –hash=STRING The hash used to create the encryption key from
the passphrase (default: “ripemd160″)
-y, –verify-passphrase Verifies the passphrase by asking for it twice
-d, –key-file=STRING Read the key from a file (can be /dev/random)
-s, –key-size=BITS The size of the encryption key (default: 256)
-b, –size=SECTORS The size of the device
-o, –offset=SECTORS The start offset in the backend device
-p, –skip=SECTORS How many sectors of the encrypted data to skip
at the beginning

Help options:
-?, –help Show this help message
–usage Show this help message

is one of:
create – create device
remove – remove device
reload – modify active device
resize – resize active device
status – show device status
is the device to create under /dev/mapper
is the encrypted device
</code></pre></div>
<p>这个 help 似乎也不能帮我们了解更多的内容。只好作测试了。</p>
<p>我用了一个 U 盘来创建 LVM，这样在<code>/dev/mapper</code> 下面就有对应的设备了。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ls -l /dev/mapper/vg0-lv0</span>
<span class="w">    </span>brw-rw—-<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>disk<span class="w"> </span><span class="m">253</span>,<span class="w"> </span><span class="m">0</span><span class="w"> </span>1月<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">22</span>:13<span class="w"> </span>/dev/mapper/vg0-lv0

<span class="c1"># mount /dev/mapper/vg0-lv0 /misc</span>

<span class="c1"># ls -l /misc</span>
<span class="w">    </span>总用量<span class="w"> </span><span class="m">12</span>
<span class="w">    </span>drwx——<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">12288</span><span class="w"> </span>1月<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">22</span>:21<span class="w"> </span>lost+found

<span class="c1"># touch /misc/one</span>

<span class="c1"># ls -l /misc</span>
<span class="w">    </span>总用量<span class="w"> </span><span class="m">12</span>
<span class="w">    </span>drwx——<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">12288</span><span class="w"> </span>1月<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">22</span>:21<span class="w"> </span>lost+found
<span class="w">    </span>-rw-r–r–<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>1月<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">22</span>:22<span class="w"> </span>one

<span class="c1"># umount /misc</span>

<span class="c1"># cryptsetup create cytest /dev/mapper/vg0-lv0</span>
<span class="w">    </span>Enter<span class="w"> </span>passphrase:mypassword

<span class="c1"># ls -l /dev/mapper/vg0-lv0</span>
<span class="w">    </span>brw-rw—-<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>disk<span class="w"> </span><span class="m">253</span>,<span class="w"> </span><span class="m">0</span><span class="w"> </span>1月<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">22</span>:13<span class="w"> </span>/dev/mapper/vg0-lv0

<span class="c1"># mount /dev/mapper/vg0-lv0 /misc</span>
<span class="w">    </span>mount:<span class="w"> </span>/dev/mapper/vg0-lv0<span class="w"> </span>already<span class="w"> </span>mounted<span class="w"> </span>or<span class="w"> </span>/misc<span class="w"> </span>busy

<span class="c1"># cryptsetup remove cytest</span>

<span class="c1"># mount /dev/mapper/vg0-lv0 /misc</span>

<span class="c1"># ls -l /misc</span>
<span class="w">    </span>总用量<span class="w"> </span><span class="m">12</span>
<span class="w">    </span>drwx——<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">12288</span><span class="w"> </span>1月<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">22</span>:21<span class="w"> </span>lost+found
<span class="w">    </span>-rw-r–r–<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>1月<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">22</span>:22<span class="w"> </span>one
</code></pre></div>
<p>加密前的设备和加密后的设备我用 <code>od</code> 命令查看了输出值，发现没有不同，看了他不是根据内容加密的，具体情况需要查<a href="http://www.saout.de/misc/dm-crypt/">官方网站</a>才知道了。</p>
<h3 id="ctrlaltdel">ctrlaltdel<a class="headerlink" href="#ctrlaltdel" title="Permanent link">&para;</a></h3>
<p>设置 <code>Ctrl-Alt-Del</code> 组合键的功能，这里有两种方式 hard 和 soft。</p>
<p>hard 表示当接受 <code>Ctrl-Alt-Del</code> 组合键时，系统立刻重启计算机，而不会调用 <code>sync(2)</code>命令，也不会作其他一些准备，这有点类似不延时的 reset 按钮。</p>
<p>而 soft 则表示 <code>Ctrl-Alt-Del</code> 组合键按下时，他发送 SIGINT 信号给 init 进程，那剩下的事情就是看 init 如何做了。</p>
<h2 id="sbin-d">/sbin 下 d 开头的命令<a class="headerlink" href="#sbin-d" title="Permanent link">&para;</a></h2>
<p>命令如下</p>
<blockquote>
<p>debugfs delpart dhclient-script dmsetup dump dump.static
debugfs.ocfs2 depmod dhcp6c dmsetup.static dump_cis
debugreiserfs dhclient dmraid dosfsck dumpe2fs</p>
</blockquote>
<p>其中 <code>dump.static</code> 软连接到 dump 命令，而 dump 程序是一个静态编译的命令。</p>
<h3 id="debugfs">debugfs<a class="headerlink" href="#debugfs" title="Permanent link">&para;</a></h3>
<p>debugfs, debufs.ocfs2, debugreiserfs 是文件系统调试工具，其中 debugfs 我使用过一次，其目的是希望恢复删除的某个文件。</p>
<p>但是实验表明，ext2 的文件系统有恢复的可能性，但是 ext3 却没有可能。在 ext3 文件系统官方站点的 FAQ 中，就有一个这样的问题，其中答案就是告诉你，采用 <code>rm -f</code> 方式删除的命令是没有办法恢复的，因为他不仅仅只是作删除的标记。</p>
<p>而 <code>ocfs2</code> 目前并不稳定，这是 Oracle 推出的一种文件系统，是为 Oracle 数据库的高可用服务的，但是在实际的项目中，ocfs 表现的并如人意。起文件系统都用得少，那么调试就更少了。</p>
<p><code>reiserfs</code> 是 SuSe 发行版本中默认的文件系统格式，RedHat 缺省是 ext2/ext3 的文件系统。 所以 debugreiserfs 也就没有用过了，加上 reiserfs 的开发者因为谋杀妻子的罪名被逮捕，因此这中文件系统前途还不知道怎么样。</p>
<h3 id="depart">depart<a class="headerlink" href="#depart" title="Permanent link">&para;</a></h3>
<p><code>delpart</code> 这 个命令很奇怪，没有 man 手册，没有 info 信息，帮助也是少得可怜，似乎很不符合 <code>*nix</code> 下程序开发的习惯。而他所属的 rpm 包又是 <code>util-linux</code>，这是一个工具集，因此 <code>rpm -qi</code> 也不能找到有用的信息。那就只能从帮助和起程序命令来看了。</p>
<p>刚看到这个名字，我以为他是 <code>parted</code> 程序的一部分，结果不是。看帮助</p>
<div class="highlight"><pre><span></span><code><span class="c1"># delpart  –help</span>
usage:<span class="w"> </span>delpart<span class="w"> </span>diskdevice<span class="w"> </span>partitionnr
</code></pre></div>
<p>似乎也应该是和分区有关系。我的猜想是他应该是删除一个指定的分区。下面是我的实验过程</p>
<p>首先把我的 U 盘分一个分区出来</p>
<div class="highlight"><pre><span></span><code><span class="c1"># fdisk -l /dev/sda</span>

Disk<span class="w"> </span>/dev/sda:<span class="w"> </span><span class="m">252</span><span class="w"> </span>MB,<span class="w"> </span><span class="m">252968960</span><span class="w"> </span>bytes
<span class="m">8</span><span class="w"> </span>heads,<span class="w"> </span><span class="m">61</span><span class="w"> </span>sectors/track,<span class="w"> </span><span class="m">1012</span><span class="w"> </span>cylinders
<span class="nv">Units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cylinders<span class="w"> </span>of<span class="w"> </span><span class="m">488</span><span class="w"> </span>*<span class="w"> </span><span class="nv">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">249856</span><span class="w"> </span>bytes

Device<span class="w"> </span>Boot<span class="w"> </span>Start<span class="w"> </span>End<span class="w"> </span>Blocks<span class="w"> </span>Id<span class="w"> </span>System
/dev/sda1<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">81</span><span class="w"> </span><span class="m">19733</span>+<span class="w"> </span><span class="m">83</span><span class="w"> </span>Linux

<span class="c1"># delpart /dev/sda 1</span>

<span class="c1"># fdisk -l /dev/sda</span>

Disk<span class="w"> </span>/dev/sda:<span class="w"> </span><span class="m">252</span><span class="w"> </span>MB,<span class="w"> </span><span class="m">252968960</span><span class="w"> </span>bytes
<span class="m">8</span><span class="w"> </span>heads,<span class="w"> </span><span class="m">61</span><span class="w"> </span>sectors/track,<span class="w"> </span><span class="m">1012</span><span class="w"> </span>cylinders
<span class="nv">Units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cylinders<span class="w"> </span>of<span class="w"> </span><span class="m">488</span><span class="w"> </span>*<span class="w"> </span><span class="nv">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">249856</span><span class="w"> </span>bytes

Device<span class="w"> </span>Boot<span class="w"> </span>Start<span class="w"> </span>End<span class="w"> </span>Blocks<span class="w"> </span>Id<span class="w"> </span>System
/dev/sda1<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">81</span><span class="w"> </span><span class="m">19733</span>+<span class="w"> </span><span class="m">83</span><span class="w"> </span>Linux

<span class="c1"># delpart /dev/sda 1</span>
BLKPG:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>device<span class="w"> </span>or<span class="w"> </span>address
</code></pre></div>
<p>从实验来看，他应该是删除一个分区的，而且我们从 delpart 程序反馈信息来看，他认为他删除了 sda1，但是 fdisk 命令却认为这个分区还在。
接下来我测试这个分区是否能 mkfs</p>
<div class="highlight"><pre><span></span><code><span class="c1"># mkfs.ext2 /dev/sda1</span>
mke2fs<span class="w"> </span><span class="m">1</span>.35<span class="w"> </span><span class="o">(</span><span class="m">28</span>-Feb-2004<span class="o">)</span>
Could<span class="w"> </span>not<span class="w"> </span>stat<span class="w"> </span>/dev/sda1<span class="w"> </span>—<span class="w"> </span>没有那个文件或目录

The<span class="w"> </span>device<span class="w"> </span>apparently<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>exist<span class="p">;</span><span class="w"> </span>did<span class="w"> </span>you<span class="w"> </span>specify<span class="w"> </span>it<span class="w"> </span>correctly?
</code></pre></div>
<p>看来真的已经删除了，但是为什么 fdisk 不这么认为呢？而且 parted 也认为这个分区是存在的</p>
<div class="highlight"><pre><span></span><code><span class="c1"># parted /dev/sda</span>
GNU<span class="w"> </span>Parted<span class="w"> </span><span class="m">1</span>.6.19
Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span><span class="m">1998</span><span class="w"> </span>–<span class="w"> </span><span class="m">2004</span><span class="w"> </span>Free<span class="w"> </span>Software<span class="w"> </span>Foundation,<span class="w"> </span>Inc.
This<span class="w"> </span>program<span class="w"> </span>is<span class="w"> </span>free<span class="w"> </span>software,<span class="w"> </span>covered<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>GNU<span class="w"> </span>General<span class="w"> </span>Public<span class="w"> </span>License.

This<span class="w"> </span>program<span class="w"> </span>is<span class="w"> </span>distributed<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>hope<span class="w"> </span>that<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>useful,<span class="w"> </span>but<span class="w"> </span>WITHOUT<span class="w"> </span>ANY<span class="w"> </span>WARRANTY<span class="p">;</span><span class="w"> </span>without
even<span class="w"> </span>the<span class="w"> </span>implied<span class="w"> </span>warranty<span class="w"> </span>of<span class="w"> </span>MERCHANTABILITY<span class="w"> </span>or<span class="w"> </span>FITNESS<span class="w"> </span>FOR<span class="w"> </span>A<span class="w"> </span>PARTICULAR<span class="w"> </span>PURPOSE.<span class="w"> </span>See<span class="w"> </span>the<span class="w"> </span>GNU
General<span class="w"> </span>Public<span class="w"> </span>License<span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>details.

使用<span class="w"> </span>/dev/sda
<span class="o">(</span>parted<span class="o">)</span><span class="w"> </span>print
/dev/sda<span class="w"> </span>的磁盘几何结构：0.000-241.250<span class="w"> </span>兆字节
磁盘标签类型：msdos
Minor<span class="w"> </span>起始点<span class="w"> </span>终止点<span class="w"> </span>类型<span class="w"> </span>文件系统<span class="w"> </span>标志
<span class="m">1</span><span class="w"> </span><span class="m">0</span>.030<span class="w"> </span><span class="m">19</span>.300<span class="w"> </span>主分区
</code></pre></div>
<p>但是内核却认为这个分区已经不存在了</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cat /proc/partitions</span>
major<span class="w"> </span>minor<span class="w"> </span><span class="c1">#blocks name</span>

<span class="m">3</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">29302560</span><span class="w"> </span>hda
<span class="m">3</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5246608</span><span class="w"> </span>hda1
<span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5178600</span><span class="w"> </span>hda2
<span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>hda3
<span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">13267768</span><span class="w"> </span>hda4
<span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5606653</span><span class="w"> </span>hda5
<span class="m">8</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">247040</span><span class="w"> </span>sda
</code></pre></div>
<p>而使用 sfdisk 命令同样也认为 sda1 存在，但是在扫描 sda1 时停止</p>
<div class="highlight"><pre><span></span><code><span class="c1"># sfdisk /dev/sda</span>
Checking<span class="w"> </span>that<span class="w"> </span>no-one<span class="w"> </span>is<span class="w"> </span>using<span class="w"> </span>this<span class="w"> </span>disk<span class="w"> </span>right<span class="w"> </span>now<span class="w"> </span>…
OK

Disk<span class="w"> </span>/dev/sda:<span class="w"> </span><span class="m">1012</span><span class="w"> </span>cylinders,<span class="w"> </span><span class="m">8</span><span class="w"> </span>heads,<span class="w"> </span><span class="m">61</span><span class="w"> </span>sectors/track
Old<span class="w"> </span>situation:
<span class="nv">Units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cylinders<span class="w"> </span>of<span class="w"> </span><span class="m">249856</span><span class="w"> </span>bytes,<span class="w"> </span>blocks<span class="w"> </span>of<span class="w"> </span><span class="m">1024</span><span class="w"> </span>bytes,<span class="w"> </span>counting<span class="w"> </span>from<span class="w"> </span><span class="m">0</span>

Device<span class="w"> </span>Boot<span class="w"> </span>Start<span class="w"> </span>End<span class="w"> </span><span class="c1">#cyls #blocks Id System</span>
/dev/sda1<span class="w"> </span><span class="m">0</span>+<span class="w"> </span><span class="m">80</span><span class="w"> </span><span class="m">81</span>-<span class="w"> </span><span class="m">19733</span>+<span class="w"> </span><span class="m">83</span><span class="w"> </span>Linux
/dev/sda2<span class="w"> </span><span class="m">0</span><span class="w"> </span>–<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>Empty
/dev/sda3<span class="w"> </span><span class="m">0</span><span class="w"> </span>–<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>Empty
/dev/sda4<span class="w"> </span><span class="m">0</span><span class="w"> </span>–<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>Empty
Input<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>format<span class="p">;</span><span class="w"> </span>absent<span class="w"> </span>fields<span class="w"> </span>get<span class="w"> </span>a<span class="w"> </span>default<span class="w"> </span>value.

Usually<span class="w"> </span>you<span class="w"> </span>only<span class="w"> </span>need<span class="w"> </span>to<span class="w"> </span>specify<span class="w"> </span>and<span class="w"> </span><span class="o">(</span>and<span class="w"> </span>perhaps<span class="w"> </span><span class="o">)</span>.

/dev/sda1<span class="w"> </span>:
</code></pre></div>
<p>后面是 <code>Ctrl+C</code> 退出的。</p>
<p>strace 了一下 fdisk 程序，没有找到原因。这个问题也暂时留下了。</p>
<h3 id="depmod">depmod<a class="headerlink" href="#depmod" title="Permanent link">&para;</a></h3>
<p>为 modprobe 工具提供一个正确的模块依赖性列表（modules.dep)。 这个命令对于新加入的模块能够像已经有的模块那样添加和删除起到了很好的作用。</p>
<p>我们知道在 Linux 中，内核模块是是在<code>/lib/modules/</code>下面的。使用 <code>insmod/modprobe</code> 默认也是从这个目录去找你要加载的模块，除非你用 <code>-f</code> 来指定模块的路径。</p>
<p>而对于编译的内核模块，如果希望 modprobe 程序能够仅仅提供模块名就可以加载的话，那么至少要做两件事情。</p>
<ol>
<li>将新的模块复制到正确的位置。</li>
<li>使用<code>depmod -A</code> 或者<code>depmod -a</code>来生产模块依赖性比列表。</li>
</ol>
<p>其中 <code>－a</code> 是表示所有模块都扫描一次，然后生成列表，而 <code>－A</code> 表示进扫描新增的或者更新的模块，然后更新模块依赖性列表。</p>
<p>这两个参数是最常用的了。我目前也就仅仅用过这两个参数。</p>
<p>刚才看了 man 手册，还有一些参数，比如 <code>－b</code> 表示模块的基本路径在哪里，利用这个参数你可以将模块从 <code>/lib/modules/</code> 中迁移出来。而 <code>-n</code> 参数表示仅仅只是打印出模块依赖性列表，而不写入，相当于仅仅是演示，而不会产生实际效果。</p>
<h3 id="dhclient">dhclient<a class="headerlink" href="#dhclient" title="Permanent link">&para;</a></h3>
<p>dhclient， dhclient-script, dhcp6 这是 DHCP 协议中用的，一般我们都不会直接去执行这几个命令，而是配置他的配置文件和运行 <code>/etc/rc.d/init.d/dhcpd</code> 命令。所以这里也不深入研究了。</p>
<h3 id="dmraid">dmraid<a class="headerlink" href="#dmraid" title="Permanent link">&para;</a></h3>
<p>device-Mapper 软 RAID 工具，他主要是用来执行设备发现，RAID 激活和 ATARAID 属性显示。因此我们需要和 RAID 制作工具一起来讲。</p>
<h3 id="dmsetup">dmsetup<a class="headerlink" href="#dmsetup" title="Permanent link">&para;</a></h3>
<p>底层逻辑卷管理(LVM)，这是 device-mapper 包中带的唯一一个可执行程序，除了那个静态版的 <code>dmsetup.static</code>。这个命令我想留到和 <code>device-mapper-multipath</code> 一起来研究，这里就不阐述了。</p>
<h3 id="dosfsck">dosfsck<a class="headerlink" href="#dosfsck" title="Permanent link">&para;</a></h3>
<p>检查和修复 MSDOS 文件系统，Linux 还真的有意思，居然来一个这样的工具，不过我从未在 Linux 下修复过 MS 的文件系统，总是感觉有点玄。</p>
<p>而且我觉得也没有机会。服务器上吧，MS 的文件系统和 Linux 的文件系统是不会存在一个硬盘上的，服务器上需要双系统吗？自己的机器上，如果有 MS 的文件系统，那么就应该有其操作系统，那么自己的工具修复自己的东西就好了。当然也不排除这种可能性：以前是有双系统，而一些数据是放在 MS 的文件系统上的，后来觉得 MS 的系统不爽，于是咔嚓掉了。</p>
<p>但是因为数据太多，其他分区也就不懂了，于是就出现了没有 MS 的系统，但是有 MS 的分区。这个时候是不是 dosfsck 能派上用场呢？</p>
<h3 id="dump">dump<a class="headerlink" href="#dump" title="Permanent link">&para;</a></h3>
<p>ext2/ext3 文件系统备份。dump 程序检查 ext&#8532; 文件系统上的文件，然后猜测那些文件需要备份。这些文件被复制到指定的磁盘，磁带或者其他存储介质上。他还可以作远程的备份。</p>
<p>如果 dump 出来的数据大于指定的备份存储介质，他将分卷。dump 支持的参数比较多。</p>
<ul>
<li><code>-level#</code> dump 级别，0 是全备份，0 以上的数字是增量备份。历史原因，dump 程序一般只使用 0-9 这几个数字，不过现在的 dump 版本支持 9 以上的数字（但是，不同的数字意味着什么，man 手册中并没有说）</li>
<li><code>-a</code> “自动大小(auto-size)”. 忽略所有磁带的长度计算。他将一直写到磁带结束，对于大部分现在的磁带机，这中工作方式是最佳的，也是缺省模式。这种方式特别是在增加数据到一个磁带上或者具有硬件压缩功能的磁带机效果更好。</li>
<li><code>-A</code> 归档文件，在指定的归档文件上创建一个 dump 内容表(table-of-contents)，将来可以被 restore(8)程序用来判断一个正准备回复的文件是否在 dump 文件中.</li>
<li><code>-b</code> 块大小.每个 dump 记录的 KB 数.缺省是 10.最大值是 1024,不过与你的内核限制有关系.</li>
<li><code>-B</code> 记录数,每卷的快数(每块 1KB).当 dump 程序发现到了存储介质的结尾时,他会要求你更换卷.</li>
<li><code>-D</code> 文件.设置存储之前先前完全或者增量 dump 信息的文件路径.</li>
<li><code>-e</code> inode 列表,不准备 dump 的 inode 列表,多个 inode 之间用逗号分隔,你可以使用 stat(1)命令来找到文件或者目录的 inode 值.</li>
<li><code>-E</code> 文件,从文件中排除不 dump 的 inode,文件格式采用一行一个 inode,而且应该是排序的.</li>
<li><code>-f</code> 文件.写备份到文件;这可以是特定的设备文件,比如/dev/st0,/dev/fd0,/dev/sdc,或者是一个普通文件,或者是标准输出(<code>-</code>)， 多个文件采用逗号分隔.每一个文件将存储一个 dump 卷.如果文件命采用 host:file 或者 user@host:file 格式,dump 将使用 rmt(8)程序将数据写入到远程机器指定的文件上(改文件应该存在,dump 不会使用创建一个远程- `文件).</li>
<li><code>-F</code> 脚本,在每一个磁带的最后执行这个脚本(除了最后一盘磁带)</li>
<li><code>-L</code> 标签,使用用户提供的字符串作为标签写入到 dump 都,这样一来,像 restore(8)和 file(8)程序就可以访问它.标签的最大长度不能超过 LBLSIZE(当前是 16)个字符,而且字符串必须是 <code>\0</code> 结尾.</li>
<li><code>-S</code> 大小评估。用来计算 dump 需要的空间，但是并不真正执行 dump 操作。这对增量备份有好处，因为可以知道需要多少存储介质。</li>
<li><code>-T</code> 时间。使用指定的时间来作为 dump 的时间，而不是从 <code>/etc/dumpdates</code> 里读取。这里时间的格式和 ctime(3) 的格式相同，遵守 RFC822 时区规范。他与 <code>-u</code> 参数是互斥的。</li>
<li><code>-u</code> 成功 dump 后，更新 <code>/etc/dumpdates</code> 文件。/etc/dumpdates 文件格式是人可以阅读的，每行记录一个时间，采取了叫宽松的格式。</li>
<li><code>-y</code> 写入磁带时压缩块，采用 lzo 链接库。</li>
<li><code>-z</code> 压缩级别，采用 zlib 库，这个参数仅在将数据 dump 到文件，管道或者磁带机时才有用，缺省值是 2.注意指定这个值的时候，参数和值之间应该没有参数</li>
</ul>
<p>下面是一个压缩到文件的简单例子</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dump -0 -f /tmp/rootdump /root</span>
DUMP:<span class="w"> </span>Date<span class="w"> </span>of<span class="w"> </span>this<span class="w"> </span>level<span class="w"> </span><span class="m">0</span><span class="w"> </span>dump:<span class="w"> </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">22</span>:06:46<span class="w"> </span><span class="m">2007</span>
DUMP:<span class="w"> </span>Dumping<span class="w"> </span>/dev/hda5<span class="w"> </span><span class="o">(</span>/<span class="w"> </span><span class="o">(</span>dir<span class="w"> </span>root<span class="o">))</span><span class="w"> </span>to<span class="w"> </span>/tmp/rootdump
DUMP:<span class="w"> </span>Label:<span class="w"> </span>/
DUMP:<span class="w"> </span>Writing<span class="w"> </span><span class="m">10</span><span class="w"> </span>Kilobyte<span class="w"> </span>records
DUMP:<span class="w"> </span>mapping<span class="w"> </span><span class="o">(</span>Pass<span class="w"> </span>I<span class="o">)</span><span class="w"> </span><span class="o">[</span>regular<span class="w"> </span>files<span class="o">]</span>
DUMP:<span class="w"> </span>mapping<span class="w"> </span><span class="o">(</span>Pass<span class="w"> </span>II<span class="o">)</span><span class="w"> </span><span class="o">[</span>directories<span class="o">]</span>
DUMP:<span class="w"> </span>estimated<span class="w"> </span><span class="m">15509</span><span class="w"> </span>blocks.
DUMP:<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span><span class="w"> </span>started<span class="w"> </span>with<span class="w"> </span>block<span class="w"> </span><span class="m">1</span><span class="w"> </span>at:<span class="w"> </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">22</span>:06:48<span class="w"> </span><span class="m">2007</span>
DUMP:<span class="w"> </span>dumping<span class="w"> </span><span class="o">(</span>Pass<span class="w"> </span>III<span class="o">)</span><span class="w"> </span><span class="o">[</span>directories<span class="o">]</span>
DUMP:<span class="w"> </span>ACLs<span class="w"> </span><span class="k">in</span><span class="w"> </span>inode<span class="w"> </span><span class="c1">#2 won&#39;t be dumped</span>
DUMP:<span class="w"> </span>ACLs<span class="w"> </span><span class="k">in</span><span class="w"> </span>inode<span class="w"> </span><span class="c1">#187672 won&#39;t be dumped</span>
DUMP:<span class="w"> </span>ACLs<span class="w"> </span><span class="k">in</span><span class="w"> </span>inode<span class="w"> </span><span class="c1">#204060 won&#39;t be dumped</span>
DUMP:<span class="w"> </span>ACLs<span class="w"> </span><span class="k">in</span><span class="w"> </span>inode<span class="w"> </span><span class="c1">#674281 won&#39;t be dumped</span>
DUMP:<span class="w"> </span>dumping<span class="w"> </span><span class="o">(</span>Pass<span class="w"> </span>IV<span class="o">)</span><span class="w"> </span><span class="o">[</span>regular<span class="w"> </span>files<span class="o">]</span>
DUMP:<span class="w"> </span>ACLs<span class="w"> </span><span class="k">in</span><span class="w"> </span>inode<span class="w"> </span><span class="c1">#505922 won&#39;t be dumped</span>
DUMP:<span class="w"> </span>ACLs<span class="w"> </span><span class="k">in</span><span class="w"> </span>inode<span class="w"> </span><span class="c1">#505923 won&#39;t be dumped</span>
DUMP:<span class="w"> </span>ACLs<span class="w"> </span><span class="k">in</span><span class="w"> </span>inode<span class="w"> </span><span class="c1">#505924 won&#39;t be dumped</span>
DUMP:<span class="w"> </span>ACLs<span class="w"> </span><span class="k">in</span><span class="w"> </span>inode<span class="w"> </span><span class="c1">#505925 won&#39;t be dumped</span>
DUMP:<span class="w"> </span>ACLs<span class="w"> </span><span class="k">in</span><span class="w"> </span>inode<span class="w"> </span><span class="c1">#505926 won&#39;t be dumped</span>
DUMP:<span class="w"> </span>ACLs<span class="w"> </span><span class="k">in</span><span class="w"> </span>inode<span class="w"> </span><span class="c1">#505927 won&#39;t be dumped</span>
...
DUMP:<span class="w"> </span>Closing<span class="w"> </span>/tmp/rootdump
DUMP:<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span><span class="w"> </span>completed<span class="w"> </span>at:<span class="w"> </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">22</span>:06:59<span class="w"> </span><span class="m">2007</span>
DUMP:<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">15340</span><span class="w"> </span>blocks<span class="w"> </span><span class="o">(</span><span class="m">14</span>.98MB<span class="o">)</span>
DUMP:<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span><span class="w"> </span>took<span class="w"> </span><span class="m">0</span>:00:11
DUMP:<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span><span class="w"> </span>transfer<span class="w"> </span>rate:<span class="w"> </span><span class="m">1394</span><span class="w"> </span>kB/s
DUMP:<span class="w"> </span><span class="m">15340</span><span class="w"> </span>blocks<span class="w"> </span><span class="o">(</span><span class="m">14</span>.98MB<span class="o">)</span><span class="w"> </span>on<span class="w"> </span><span class="m">1</span><span class="w"> </span>volume<span class="o">(</span>s<span class="o">)</span>
DUMP:<span class="w"> </span>finished<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">11</span><span class="w"> </span>seconds,<span class="w"> </span>throughput<span class="w"> </span><span class="m">1394</span><span class="w"> </span>kBytes/sec
DUMP:<span class="w"> </span>Date<span class="w"> </span>of<span class="w"> </span>this<span class="w"> </span>level<span class="w"> </span><span class="m">0</span><span class="w"> </span>dump:<span class="w"> </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">22</span>:06:46<span class="w"> </span><span class="m">2007</span>
DUMP:<span class="w"> </span>Date<span class="w"> </span>this<span class="w"> </span>dump<span class="w"> </span>completed:<span class="w"> </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">22</span>:06:59<span class="w"> </span><span class="m">2007</span>
DUMP:<span class="w"> </span>Average<span class="w"> </span>transfer<span class="w"> </span>rate:<span class="w"> </span><span class="m">1394</span><span class="w"> </span>kB/s
DUMP:<span class="w"> </span>DUMP<span class="w"> </span>IS<span class="w"> </span>DONE
</code></pre></div>
<p>我们来看看 dump 出来的文件是有什么特征</p>
<div class="highlight"><pre><span></span><code><span class="c1"># file /tmp/rootdump</span>
/tmp/rootdump:<span class="w"> </span>new-fs<span class="w"> </span>dump<span class="w"> </span>file<span class="w"> </span><span class="o">(</span>little<span class="w"> </span>endian<span class="o">)</span>,<span class="w"> </span>This<span class="w"> </span>dump<span class="w"> </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">22</span>:06:46<span class="w"> </span><span class="m">2007</span>,<span class="w"> </span>Previous<span class="w"> </span>dump<span class="w"> </span>Thu<span class="w"> </span>Jan<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">08</span>:00:00<span class="w"> </span><span class="m">1970</span>,<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>Level<span class="w"> </span>zero,<span class="w"> </span>type:<span class="w"> </span>tape<span class="w"> </span>header,<span class="w"> </span>Label<span class="w"> </span>/,<span class="w"> </span>Filesystem<span class="w"> </span>/<span class="w"> </span><span class="o">(</span>dir<span class="w"> </span>root<span class="o">)</span>,<span class="w"> </span>Device<span class="w"> </span>/dev/hda5,<span class="w"> </span>Host<span class="w"> </span>lancy,<span class="w"> </span>Flags<span class="w"> </span><span class="m">3</span>

<span class="c1"># du -sh /tmp/rootdump</span>
15M<span class="w"> </span>/tmp/rootdump

<span class="c1"># du -sh /root</span>
15M<span class="w"> </span>/root
</code></pre></div>
<p>在不指定 <code>-z</code> 参数时，dump 是没有压缩效果的。</p>
<p>再看看压缩效果</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dump -0 -z9 -f /tmp/rootdump.z9 /root</span>
......
<span class="c1">#ls -h /tmp/rootdump.z9</span>
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">7</span>.4M
Jan<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">20</span>:56<span class="w"> </span>/tmp/rootdump.z9
</code></pre></div>
<p>看上去效果还不错</p>
<h3 id="dump_cis">dump_cis<a class="headerlink" href="#dump_cis" title="Permanent link">&para;</a></h3>
<p>显示 PCMCIA 设别的信息。因为我的无线上网卡不这次，因此他仅仅给出了下面的信息</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dump_cis no pcmcia driver in /proc/devices</span>
</code></pre></div>
<h3 id="dumpe2fs">dumpe2fs<a class="headerlink" href="#dumpe2fs" title="Permanent link">&para;</a></h3>
<p>导出 ext2/ext3 文件系统信息，显然这也是一个重量级的工具，在文件系统出现损坏的情况下用得着。</p>
<p>他打印出文件系统的超级块和块组信息。我们先看一个具体的例子，下面是对我刚创建个一个分区的 dump 信息。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dumpe2fs /dev/sda1</span>
dumpe2fs<span class="w"> </span><span class="m">1</span>.35<span class="w"> </span><span class="o">(</span><span class="m">28</span>-Feb-2004<span class="o">)</span>
Filesystem<span class="w"> </span>volume<span class="w"> </span>name:
Last<span class="w"> </span>mounted<span class="w"> </span>on:
Filesystem<span class="w"> </span>UUID:<span class="w"> </span>f74b41c6-637f-436f-ab9c-e1cbd532abf8
Filesystem<span class="w"> </span>magic<span class="w"> </span>number:<span class="w"> </span>0xEF53
Filesystem<span class="w"> </span>revision<span class="w"> </span><span class="c1">#: 1 (dynamic)</span>
Filesystem<span class="w"> </span>features:<span class="w"> </span>has_journal<span class="w"> </span>resize_inode<span class="w"> </span>filetype<span class="w"> </span>sparse_super
Default<span class="w"> </span>mount<span class="w"> </span>options:<span class="w"> </span><span class="o">(</span>none<span class="o">)</span>
Filesystem<span class="w"> </span>state:<span class="w"> </span>clean
Errors<span class="w"> </span>behavior:<span class="w"> </span>Continue
Filesystem<span class="w"> </span>OS<span class="w"> </span>type:<span class="w"> </span>Linux
Inode<span class="w"> </span>count:<span class="w"> </span><span class="m">4944</span>
Block<span class="w"> </span>count:<span class="w"> </span><span class="m">19732</span>
Reserved<span class="w"> </span>block<span class="w"> </span>count:<span class="w"> </span><span class="m">986</span>
Free<span class="w"> </span>blocks:<span class="w"> </span><span class="m">17905</span>
Free<span class="w"> </span>inodes:<span class="w"> </span><span class="m">4933</span>
First<span class="w"> </span>block:<span class="w"> </span><span class="m">1</span>
Block<span class="w"> </span>size:<span class="w"> </span><span class="m">1024</span>
Fragment<span class="w"> </span>size:<span class="w"> </span><span class="m">1024</span>
Reserved<span class="w"> </span>GDT<span class="w"> </span>blocks:<span class="w"> </span><span class="m">77</span>
Blocks<span class="w"> </span>per<span class="w"> </span>group:<span class="w"> </span><span class="m">8192</span>
Fragments<span class="w"> </span>per<span class="w"> </span>group:<span class="w"> </span><span class="m">8192</span>
Inodes<span class="w"> </span>per<span class="w"> </span>group:<span class="w"> </span><span class="m">1648</span>
Inode<span class="w"> </span>blocks<span class="w"> </span>per<span class="w"> </span>group:<span class="w"> </span><span class="m">206</span>
Filesystem<span class="w"> </span>created:<span class="w"> </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">21</span>:43:19<span class="w"> </span><span class="m">2007</span>
Last<span class="w"> </span>mount<span class="w"> </span>time:<span class="w"> </span>n/a
Last<span class="w"> </span>write<span class="w"> </span>time:<span class="w"> </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">21</span>:43:19<span class="w"> </span><span class="m">2007</span>
Mount<span class="w"> </span>count:<span class="w"> </span><span class="m">0</span>
Maximum<span class="w"> </span>mount<span class="w"> </span>count:<span class="w"> </span><span class="m">26</span>
Last<span class="w"> </span>checked:<span class="w"> </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">21</span>:43:19<span class="w"> </span><span class="m">2007</span>
Check<span class="w"> </span>interval:<span class="w"> </span><span class="m">15552000</span><span class="w"> </span><span class="o">(</span><span class="m">6</span><span class="w"> </span>months<span class="o">)</span>
Next<span class="w"> </span>check<span class="w"> </span>after:<span class="w"> </span>Fri<span class="w"> </span>Jul<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">21</span>:43:19<span class="w"> </span><span class="m">2007</span>
Reserved<span class="w"> </span>blocks<span class="w"> </span>uid:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>user<span class="w"> </span>root<span class="o">)</span>
Reserved<span class="w"> </span>blocks<span class="w"> </span>gid:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>group<span class="w"> </span>root<span class="o">)</span>
First<span class="w"> </span>inode:<span class="w"> </span><span class="m">11</span>
Inode<span class="w"> </span>size:<span class="w"> </span><span class="m">128</span>
Journal<span class="w"> </span>inode:<span class="w"> </span><span class="m">8</span>
Default<span class="w"> </span>directory<span class="w"> </span>hash:<span class="w"> </span>tea
Directory<span class="w"> </span>Hash<span class="w"> </span>Seed:<span class="w"> </span>d1aef805-54e4-4d41-90f7-e509a85a7028
Journal<span class="w"> </span>backup:<span class="w"> </span>inode<span class="w"> </span>blocks

Group<span class="w"> </span><span class="m">0</span>:<span class="w"> </span><span class="o">(</span>Blocks<span class="w"> </span><span class="m">1</span>-8192<span class="o">)</span>
Primary<span class="w"> </span>superblock<span class="w"> </span>at<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>Group<span class="w"> </span>descriptors<span class="w"> </span>at<span class="w"> </span><span class="m">2</span>-2
Block<span class="w"> </span>bitmap<span class="w"> </span>at<span class="w"> </span><span class="m">80</span><span class="w"> </span><span class="o">(</span>+79<span class="o">)</span>,<span class="w"> </span>Inode<span class="w"> </span>bitmap<span class="w"> </span>at<span class="w"> </span><span class="m">81</span><span class="w"> </span><span class="o">(</span>+80<span class="o">)</span>
Inode<span class="w"> </span>table<span class="w"> </span>at<span class="w"> </span><span class="m">82</span>-287<span class="w"> </span><span class="o">(</span>+81<span class="o">)</span>
<span class="m">6861</span><span class="w"> </span>free<span class="w"> </span>blocks,<span class="w"> </span><span class="m">1637</span><span class="w"> </span>free<span class="w"> </span>inodes,<span class="w"> </span><span class="m">2</span><span class="w"> </span>directories
Free<span class="w"> </span>blocks:<span class="w"> </span><span class="m">1332</span>-8192
Free<span class="w"> </span>inodes:<span class="w"> </span><span class="m">12</span>-1648
Group<span class="w"> </span><span class="m">1</span>:<span class="w"> </span><span class="o">(</span>Blocks<span class="w"> </span><span class="m">8193</span>-16384<span class="o">)</span>
Backup<span class="w"> </span>superblock<span class="w"> </span>at<span class="w"> </span><span class="m">8193</span>,<span class="w"> </span>Group<span class="w"> </span>descriptors<span class="w"> </span>at<span class="w"> </span><span class="m">8194</span>-8194
Block<span class="w"> </span>bitmap<span class="w"> </span>at<span class="w"> </span><span class="m">8272</span><span class="w"> </span><span class="o">(</span>+79<span class="o">)</span>,<span class="w"> </span>Inode<span class="w"> </span>bitmap<span class="w"> </span>at<span class="w"> </span><span class="m">8273</span><span class="w"> </span><span class="o">(</span>+80<span class="o">)</span>
Inode<span class="w"> </span>table<span class="w"> </span>at<span class="w"> </span><span class="m">8274</span>-8479<span class="w"> </span><span class="o">(</span>+81<span class="o">)</span>
<span class="m">7905</span><span class="w"> </span>free<span class="w"> </span>blocks,<span class="w"> </span><span class="m">1648</span><span class="w"> </span>free<span class="w"> </span>inodes,<span class="w"> </span><span class="m">0</span><span class="w"> </span>directories
Free<span class="w"> </span>blocks:<span class="w"> </span><span class="m">8480</span>-16384
Free<span class="w"> </span>inodes:<span class="w"> </span><span class="m">1649</span>-3296
Group<span class="w"> </span><span class="m">2</span>:<span class="w"> </span><span class="o">(</span>Blocks<span class="w"> </span><span class="m">16385</span>-19731<span class="o">)</span>
Block<span class="w"> </span>bitmap<span class="w"> </span>at<span class="w"> </span><span class="m">16385</span><span class="w"> </span><span class="o">(</span>+0<span class="o">)</span>,<span class="w"> </span>Inode<span class="w"> </span>bitmap<span class="w"> </span>at<span class="w"> </span><span class="m">16386</span><span class="w"> </span><span class="o">(</span>+1<span class="o">)</span>
Inode<span class="w"> </span>table<span class="w"> </span>at<span class="w"> </span><span class="m">16387</span>-16592<span class="w"> </span><span class="o">(</span>+2<span class="o">)</span>
<span class="m">3139</span><span class="w"> </span>free<span class="w"> </span>blocks,<span class="w"> </span><span class="m">1648</span><span class="w"> </span>free<span class="w"> </span>inodes,<span class="w"> </span><span class="m">0</span><span class="w"> </span>directories
Free<span class="w"> </span>blocks:<span class="w"> </span><span class="m">16593</span>-19731
Free<span class="w"> </span>inodes:<span class="w"> </span><span class="m">3297</span>-4944
</code></pre></div>
<p>从这个 dump 信息我们能够得到几个很重要的信息，无论对于你将来的正在备份，恢复还是文件系统修复都是至关重要的。</p>
<div class="highlight"><pre><span></span><code>Free blocks: 17905 //能够存储数据的块大小
Free inodes: 4933 //能够使用的 i 节点 Block
size: 1024 //块大小
Primary superblock at 1，Backup superblock at 8193 //主超级块以及备份超级块的位置
</code></pre></div>
<p>free blocks 和 block size 决定了存储数据的空间大小，同时 block size 在某些备份软件中是需要指定的。
而 free inode 表说明能够创建的文件或目录总和。</p>
<p>因为一个文件或目录需要占用一个 inode 节点。因此即使你的空间还足够，但是你会发现你无法创建文件或者目录，而提示却是空间不够，
这个时候你可以用 dumpe2fs 来看看你还有多少 free inode。当然仅仅为了查看 inode 节点的信息，不仅仅只有 dumpe2fs 能够
做得到。</p>
<p><code>df -i</code> 命令也可以查看到 inode 节点的使用信息。</p>
<p>而适当的改变 block size 可以在同样空间里获得更多的 inode，这个我们在说 mkfs 的时候再讨论。</p>
<p>superblock 无疑是整个文件系统的核心，类似通往文件系统存储空间的钥匙，没有了钥匙，你既无法继续存储数据，也无法取出原来的数据。</p>
<p>正是因为他是如此的重要，所以文件系统在一创建的就做了若干备份。而且空间越大，备份的数目越多，以我的根文件系统为例，大小是<code>5.3G</code>.</p>
<p>其中超级块一共 8 个。一旦文件系统的超级块损坏，我们立刻可以使用 <code>e2fsck -b xxxx</code> 的方式启用备用的超级块。</p>
<p>这里的 xxx 就是你的备份超级块的位置，上面的例子中，第一个超级块备份位置是 8193，因此你可以使用</p>
<p><code>e2fsck -b 8193 /dev/sda1</code></p>
<p>来恢复超级块。</p>
<p>除了这些重要信息外，对 dumpe2fs 的深入分析，甚至可以将一个一经无法通过恢复超级块来访问的文件系统的数据导出来。</p>
<h2 id="sbin-e">/sbin/ 下 e 开头的命令<a class="headerlink" href="#sbin-e" title="Permanent link">&para;</a></h2>
<p>/sbin/ 下 e 开头的命令比较多，列举如下：</p>
<div class="highlight"><pre><span></span><code>e2fsck ela_remove elvtune evlfacility evlogmgr evSubagent
e2image ela_remove_all ether-wake evlgentmpls evlogrmtd
e2label ela_show ethtool evlnotify evlsend
ela_add ela_show_all evlactiond evlnotifyd evltc
ela_get_atts ela_sig_send evlconfig evlogd evlview
</code></pre></div>
<h3 id="e2fsck">e2fsck<a class="headerlink" href="#e2fsck" title="Permanent link">&para;</a></h3>
<p>检查和修复 ext2/ext3 文件系统，这似乎是目前 Linux 下唯一一个对文件系统做修复的工具。</p>
<p>他同时也是一个双刃剑。在实际的文件系统修复经验中，我遇到了两难的问题。根文件系统损坏了，需要修复，系统会提示你要用 e2fsck 来修复。
当然你可以按照他的提示去做，但是很可能，你会发现，等你修复完了，文件系统也能正常工作了，但是往往最重要的文件被修复得不加了。
这不是开玩笑，而是有大量的案例。如果在修复和损坏之间取得一种平衡需要根据具体的情况来定夺。</p>
<p>e2fsck 接受的参数比较多，列举如下：</p>
<ul>
<li><code>-a</code>: 不询问使用者意见，便自动修复文件系统</li>
<li><code>-b</code>: 指定 superblock，而不使用预设的 superblock</li>
<li><code>-B</code>: 指定区块的大小，单位为字节</li>
<li><code>-c</code>: 一并执行 badblocks，以标示损坏的区块</li>
<li><code>-C</code>: 将检查过程的信息完整记录在 file descriptor 中，使得整个检查过程都能完整监控</li>
<li><code>-d</code>: 显示排错信息</li>
<li><code>-f</code>: 即使文件系统没有错误迹象，仍强制地检查正确性</li>
<li><code>-F</code>: 执行前先清除设备的缓冲区</li>
<li><code>-l</code>: 将文件中指定的区块加到损坏区块列表</li>
<li><code>-L</code>: 先清除损坏区块列表，再将文件中指定的区块加到损坏区块列表。因此损坏区块列表的区块跟文件中指定的区块是一样的</li>
<li><code>-n</code>: 以只读模式开启文件系统，并采取非互动方式执行，所有的问题对话均设置以"no"回答</li>
<li><code>-p</code>: 不询问使用者意见，便自动修复文件系统</li>
<li><code>-r</code>: 此参数只为了兼容性而存在，并无实际作用</li>
<li><code>-s</code>: 如果文件系统的字节顺序不适当，就交换字节顺序，否则不做任何动作</li>
<li><code>-S</code>: 不管文件系统的字节顺序，一律交换字节顺序</li>
<li><code>-t</code>: 显示时间信息</li>
<li><code>-v</code>: 执行时显示详细的信息</li>
<li><code>-V</code>: 显示版本信息</li>
<li><code>-y</code>: 采取非互动方式执行，所有的问题均设置以"yes"回答。</li>
</ul>
<p>e2fsck 执行后的传回值及代表意义如下：</p>
<ul>
<li>0: 没有任何错误发生。</li>
<li>1: 文件系统发生错误，并且已经修正。</li>
<li>2: 文件系统发生错误，并且已经修正。</li>
<li>4: 文件系统发生错误，但没有修正。</li>
<li>8: 运作时发生错误。</li>
<li>16: 使用的语法发生错误。</li>
<li>128: 共享的函数库发生错误。</li>
</ul>
<h3 id="e2image">e2image<a class="headerlink" href="#e2image" title="Permanent link">&para;</a></h3>
<p>保存关键的 ext2/ext3 文件系统到文件。 e2image 可以用来创建 ext2 和 ext3 文件系统的镜像。<br />
e2image 只解释需要被镜像的文件系统，而不是保存原始 bit。<br />
e2image 可以创建 <code>raw</code> 和 <code>nomal</code> 镜像，这两种方法都可以节约空间。</p>
<p>因此，用 e2image 创建的镜像同硬盘上的文件系统有不同的 hash，从这点上看，他是和 dd 命令不同的。</p>
<p>但是如何将 e2image 创建的备份恢复出来呢？这点在 e2image 的 help 和 man 手册中都没有提到</p>
<p>下面是一个实际的例子，分部创建了 <code>raw</code> 和 <code>normal</code> 镜像</p>
<div class="highlight"><pre><span></span><code><span class="c1"># e2image /dev/sda1 /tmp/e2image.data</span>
e2image<span class="w"> </span><span class="m">1</span>.35<span class="w"> </span><span class="o">(</span><span class="m">28</span>-Feb-2004<span class="o">)</span>

<span class="c1"># ls -lh /tmp/e2image.data</span>
-rw——-<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span>625K<span class="w"> </span>1月<span class="w"> </span><span class="m">31</span><span class="w"> </span><span class="m">21</span>:18<span class="w"> </span>/tmp/e2image.data

<span class="c1"># file /tmp/e2image.data</span>
/tmp/e2image.data:<span class="w"> </span>Linux<span class="w"> </span>rev<span class="w"> </span><span class="m">1</span>.0<span class="w"> </span>ext3<span class="w"> </span>filesystem<span class="w"> </span>data

<span class="c1"># mount /tmp/e2image.data /misc -oloop</span>
mount:<span class="w"> </span>wrong<span class="w"> </span>fs<span class="w"> </span>type,<span class="w"> </span>bad<span class="w"> </span>option,<span class="w"> </span>bad<span class="w"> </span>superblock<span class="w"> </span>on<span class="w"> </span>/dev/loop0,
or<span class="w"> </span>too<span class="w"> </span>many<span class="w"> </span>mounted<span class="w"> </span>file<span class="w"> </span>systems
<span class="o">(</span>could<span class="w"> </span>this<span class="w"> </span>be<span class="w"> </span>the<span class="w"> </span>IDE<span class="w"> </span>device<span class="w"> </span>where<span class="w"> </span>you<span class="w"> </span><span class="k">in</span><span class="w"> </span>fact<span class="w"> </span>use
ide-scsi<span class="w"> </span>so<span class="w"> </span>that<span class="w"> </span>sr0<span class="w"> </span>or<span class="w"> </span>sda<span class="w"> </span>or<span class="w"> </span>so<span class="w"> </span>is<span class="w"> </span>needed?<span class="o">)</span>

<span class="c1"># mount -r /tmp/e2image.data /tmp/e2image_raw_data</span>
mount:<span class="w"> </span>mount<span class="w"> </span>point<span class="w"> </span>/tmp/e2image_raw_data<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>exist

<span class="c1"># e2image -r /dev/sda1 /tmp/e2image_raw_data</span>
e2image<span class="w"> </span><span class="m">1</span>.35<span class="w"> </span><span class="o">(</span><span class="m">28</span>-Feb-2004<span class="o">)</span>

<span class="c1"># ls -lh /tmp/e2image_raw_data</span>
-rw——-<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span>20M<span class="w"> </span>1月<span class="w"> </span><span class="m">31</span><span class="w"> </span><span class="m">21</span>:20<span class="w"> </span>/tmp/e2image_raw_data

<span class="c1"># file /tmp/e2image_raw_data</span>
/tmp/e2image_raw_data:<span class="w"> </span>Linux<span class="w"> </span>rev<span class="w"> </span><span class="m">1</span>.0<span class="w"> </span>ext3<span class="w"> </span>filesystem<span class="w"> </span>data

<span class="c1"># mount /tmp/e2image_raw_data /misc -oloop</span>

<span class="c1"># df -h</span>
Filesystem<span class="w">            </span>容量<span class="w"> </span>已用<span class="w"> </span>可用<span class="w"> </span>已用%<span class="w"> </span>挂载点
/tmp/e2image_raw_data<span class="w"> </span>19M<span class="w"> </span><span class="m">1</span>.2M<span class="w"> </span>17M<span class="w"> </span><span class="m">7</span>%<span class="w"> </span>/misc

<span class="c1"># mount /dev/sda1 /misc</span>

<span class="c1"># df -h</span>
Filesystem<span class="w"> </span>容量<span class="w"> </span>已用<span class="w"> </span>可用<span class="w"> </span>已用%<span class="w"> </span>挂载点
/dev/sda1<span class="w"> </span>19M<span class="w"> </span><span class="m">1</span>.2M<span class="w"> </span>17M<span class="w"> </span><span class="m">7</span>%<span class="w"> </span>/misc
</code></pre></div>
<h3 id="e2label">e2label<a class="headerlink" href="#e2label" title="Permanent link">&para;</a></h3>
<p>显示或者修改 ext2/ext3 文件系统的标签。没有注意过从哪个版本开始，<code>/etc/fstab</code> 文件里的挂载设备名不再是实际的设备名称了，取而代之的是其标签，这增加了其灵活性，
特别是当删除并不是最后一个去分区时，在此分区前的设备号都会提前一位，如果 <code>/etc/fstab</code> 写入的是实际的设备名称，那显然这种情况下，
系统也许找不到需要的设备。而采用标签的话，只要标签不重复，即使设备有 sda 变成了 sdb，Linux 系统依然能正常启动。</p>
<p>这个命令非常简单。看下面的实例就明白了</p>
<div class="highlight"><pre><span></span><code><span class="c1"># e2label /dev/sda1</span>

<span class="c1"># e2label /dev/sda1 newlabel</span>

<span class="c1"># e2label /dev/sda1</span>
newlabel
</code></pre></div>
<h3 id="elvtune">elvtune<a class="headerlink" href="#elvtune" title="Permanent link">&para;</a></h3>
<p>I/O 电梯调试器，允许你调试每一个块设备的 I／O 电梯算法，但是还没有实现一路和二路电梯算法。</p>
<p>同时对于 LVM 而言，调试器仅仅在物理卷(PV)上有效果，对逻辑卷（LV）没有用。</p>
<p>不过这个命令要求的设备参数是/dev/blkdevX (X 表示数字），我尝试传递 /dev/sda1,/dev/hda1，均报告无效的参数。</p>
<p>所以没有觉得这个命令到底能给我们带来什么，特别是在 man 手册的历史一项中这样写道：</p>
<blockquote>
<p>Ioctls for tuning elevator behaviour were added in Linux 2.3.99-pre1.</p>
</blockquote>
<p>感觉应该是一个临时工具，但是他属于 util-linux 工具包，不解。</p>
<h3 id="ether-wake">ether-wake<a class="headerlink" href="#ether-wake" title="Permanent link">&para;</a></h3>
<p>这个命令用来产生和发送一个 Wake-On-LAN(WOL)数据包(MagicPacker)包，用来重启软关机的机器。这个玩意没有办法测试，也不知道实际环境中是否用得多。</p>
<h3 id="ethtool">ethtool<a class="headerlink" href="#ethtool" title="Permanent link">&para;</a></h3>
<p>显示或修改以太网卡的设置，这里的设置真的是硬件方面的，比如强制为半双工等。</p>
<p>最开始我用这个命令是有一个用户说他的网卡明明是全双工的，为什么系统里看到的是半双工呀，有什么办法改吗？ifconfig 命令看了半天后没有找到好的设置方式，
后来找到了这个 ethtool，解决了问题。其实 mii-tool 也能做到这点，但是有些网卡驱动目前还与支持 mii-tool 工具。</p>
<p>ethtool 的命令比较复杂，参数也多，我们看几个例子，然后列出 man 手册。</p>
<p><strong>打印当前网卡的配置信息</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># ethtool eth0</span>
Settings<span class="w"> </span><span class="k">for</span><span class="w"> </span>eth0:
Supported<span class="w"> </span>ports:<span class="w"> </span><span class="o">[</span><span class="w"> </span>TP<span class="w"> </span>MII<span class="w"> </span><span class="o">]</span>
Supported<span class="w"> </span>link<span class="w"> </span>modes:<span class="w"> </span>10baseT/Half<span class="w"> </span>10baseT/Full
100baseT/Half<span class="w"> </span>100baseT/Full
Supports<span class="w"> </span>auto-negotiation:<span class="w"> </span>Yes
Advertised<span class="w"> </span>link<span class="w"> </span>modes:<span class="w"> </span>10baseT/Half<span class="w"> </span>10baseT/Full
100baseT/Half<span class="w"> </span>100baseT/Full
Advertised<span class="w"> </span>auto-negotiation:<span class="w"> </span>No<span class="w"> </span>注：自动协商关闭
Speed:<span class="w"> </span>100Mb/s<span class="w"> </span>//<span class="w"> </span>100Mb
Duplex:<span class="w"> </span>Full<span class="w"> </span>//全双工
Port:<span class="w"> </span>MII<span class="w"> </span>/支持mii模式
PHYAD:<span class="w"> </span><span class="m">32</span>
Transceiver:<span class="w"> </span>internal
Auto-negotiation:<span class="w"> </span>off
Supports<span class="w"> </span>Wake-on:<span class="w"> </span>pumbg
Wake-on:<span class="w"> </span>d
Current<span class="w"> </span>message<span class="w"> </span>level:<span class="w"> </span><span class="m">0</span>×00000007<span class="w"> </span><span class="o">(</span><span class="m">7</span><span class="o">)</span>
Link<span class="w"> </span>detected:<span class="w"> </span>yes
</code></pre></div>
<p><strong>将网卡修改成 10Mbps，半双工</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># ethtool -s eth1 speed 10 duplex half</span>
<span class="c1"># ethtool eth1</span>
Settings<span class="w"> </span><span class="k">for</span><span class="w"> </span>eth1:
Supported<span class="w"> </span>ports:<span class="w"> </span><span class="o">[</span><span class="w"> </span>TP<span class="w"> </span>MII<span class="w"> </span><span class="o">]</span>
Supported<span class="w"> </span>link<span class="w"> </span>modes:<span class="w"> </span>10baseT/Half<span class="w"> </span>10baseT/Full
100baseT/Half<span class="w"> </span>100baseT/Full
Supports<span class="w"> </span>auto-negotiation:<span class="w"> </span>Yes
Advertised<span class="w"> </span>link<span class="w"> </span>modes:<span class="w"> </span>10baseT/Half<span class="w"> </span>10baseT/Full
100baseT/Half<span class="w"> </span>100baseT/Full
Advertised<span class="w"> </span>auto-negotiation:<span class="w"> </span>No
Speed:<span class="w"> </span>10Mb/s<span class="w"> </span><span class="c1"># 10Mbps</span>
Duplex:<span class="w"> </span>Half<span class="w"> </span><span class="c1">#已经修改为半双工了</span>
Port:<span class="w"> </span>MII
PHYAD:<span class="w"> </span><span class="m">32</span>
Transceiver:<span class="w"> </span>internal
Auto-negotiation:<span class="w"> </span>off
Supports<span class="w"> </span>Wake-on:<span class="w"> </span>pumbg
Wake-on:<span class="w"> </span>d
Current<span class="w"> </span>message<span class="w"> </span>level:<span class="w"> </span><span class="m">0</span>×00000007<span class="w"> </span><span class="o">(</span><span class="m">7</span><span class="o">)</span>
Link<span class="w"> </span>detected:<span class="w"> </span>no
</code></pre></div>
<p><strong>将网卡修改为 100M，全双工</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># ethtool -s eth1 speed 100 duplex full</span>
<span class="c1"># ethtool eth1</span>
Settings<span class="w"> </span><span class="k">for</span><span class="w"> </span>eth1:
Supported<span class="w"> </span>ports:<span class="w"> </span><span class="o">[</span><span class="w"> </span>TP<span class="w"> </span>MII<span class="w"> </span><span class="o">]</span>
Supported<span class="w"> </span>link<span class="w"> </span>modes:<span class="w"> </span>10baseT/Half<span class="w"> </span>10baseT/Full
100baseT/Half<span class="w"> </span>100baseT/Full
Supports<span class="w"> </span>auto-negotiation:<span class="w"> </span>Yes
Advertised<span class="w"> </span>link<span class="w"> </span>modes:<span class="w"> </span>10baseT/Half<span class="w"> </span>10baseT/Full
100baseT/Half<span class="w"> </span>100baseT/Full
Advertised<span class="w"> </span>auto-negotiation:<span class="w"> </span>No
Speed:<span class="w"> </span>100Mb/s<span class="w"> </span><span class="c1">#</span>
Duplex:<span class="w"> </span>Full<span class="w"> </span><span class="c1">#</span>
Port:<span class="w"> </span>MII
PHYAD:<span class="w"> </span><span class="m">32</span>
Transceiver:<span class="w"> </span>internal
Auto-negotiation:<span class="w"> </span>off
Supports<span class="w"> </span>Wake-on:<span class="w"> </span>pumbg
Wake-on:<span class="w"> </span>d
Current<span class="w"> </span>message<span class="w"> </span>level:<span class="w"> </span><span class="m">0</span>×00000007<span class="w"> </span><span class="o">(</span><span class="m">7</span><span class="o">)</span>
Link<span class="w"> </span>detected:<span class="w"> </span>no
</code></pre></div>
<p>我们再看看 man 手册</p>
<div class="highlight"><pre><span></span><code> ethtool ethX #显示网卡的
 ethtool -h #打印帮助
 ethtool -a ethX #查询指定网卡的暂停(pause)参数信息
 ethtool -A ethX [autoneg on|off] [rx on|off] [tx on|off] #设置暂停参数
 ethtool -c ethX #查询指定网卡的联合(coalesc)信息

 ethtool -C ethX [adaptive-rx on|off] [adaptive-tx on|off] [rx-usecs N]
 [rx-frames N] [rx-usecs-irq N] [rx-frames-irq N] [tx-usecs N] [tx-
 frames N] [tx-usecs-irq N] [tx-frames-irq N] [stats-block-usecs N]
 [pkt-rate-low N] [rx-usecs-low N] [rx-frames-low N] [tx-usecs-low N]
 [tx-frames-low N] [pkt-rate-high N] [rx-usecs-high N] [rx-frames-high
 N] [tx-usecs-high N] [tx-frames-high N] [sample-interval N] #设置指定网卡的联合信息

 ethtool -g ethX #查询网卡的RX/TX参数信息
 ethtool -G ethX [rx N] [rx-mini N] [rx-jumbo N] [tx N] #设置网卡的RX/TX参数
 ethtool -i ethX #查询与网卡关联的驱动信息
 ethtool -d ethX #重新获取和打印一个网卡的注册dump信息
 ethtool -e ethX [raw on|off] [offset N] [length N] #重新获取和打印网卡的EEPROMdump信息
 ethtool -E ethX [magic N] [offset N] [value N] #修改网卡的EEPROM字节
 ethtool -k ethX #查询网卡的卸载(offload)信息
 ethtool -K ethX [rx on|off] [tx on|off] [sg on|off] [tso on|off] #修改网卡的卸载参数
 ethtool -r ethX #重启网卡的自动协商(auto-negotiation)功能，如果这个功能设置位可用的话
 ethtool -t ethX [offline|online] #执行网卡自检程序
 ethtool -s ethX [speed 10|100|1000] [duplex half|full]
 [port tp|aui|bnc|mii] [autoneg on|off] [phyad N] [xcvr internal|exter-
 nal] [wol p|u|m|b|a|g|s|d...] [sopass xx:yy:zz:aa:bb:cc] [msglvl N] #可以修改的参数值，用-s来标志
</code></pre></div>
<p>这些设置仅仅在当前生效，一旦重启网络或者重启系统，ethtool 的设置将会失效。我们可以把 ethtool 的设置命令加入到 ifcfg-ethX 配置文件中。
比如，你希望把第一块网卡设置为全双工，自适应和 100M 的方式，那么你可以在你的 <code>/etc/sysconfig/network-scripts/ifcfg-eth0</code> 文件中加入下面一行：</p>
<div class="highlight"><pre><span></span><code>ETHTOOL_OPTS=&quot;speed 100 duplex full autoneg off&quot;
</code></pre></div>
<h2 id="sbin-f">/sbin 下 f 开头的命令如下<a class="headerlink" href="#sbin-f" title="Permanent link">&para;</a></h2>
<blockquote>
<p>fdisk fixfiles fsck.cramfs fsck.ext3 fsck.ocfs2 fsck.vfat fuser findfs<br />
fsck fsck.ext2 fsck.msdos fsck.reiserfs fsck.xfs fxload</p>
</blockquote>
<p>其中<code>fsck.reiserfs</code> 是 <code>reiserfsck</code> 命令的软连接，f 开头的命令中 fsck 命令套件占了绝大部分。</p>
<h3 id="findfs">findfs<a class="headerlink" href="#findfs" title="Permanent link">&para;</a></h3>
<p>根据标签(label)或者 UUID 号来查询文件系统。他会搜索整个磁盘，看是否有匹配的标签或者 UUID 没有，如果有，则打印到标注输出上。他也是<a href="http://e2fsprogs.sf.net">e2fsprogs</a>项目的一部分。</p>
<p>一个简单的例子：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># findfs –help</span>
Usage:<span class="w"> </span>findfs<span class="w"> </span><span class="nv">LABEL</span><span class="o">=</span><span class="p">|</span><span class="nv">UUID</span><span class="o">=</span>

<span class="c1"># findfs LABEL=/</span>
/dev/hda5

<span class="c1"># findfs LABEL=/home</span>
findfs:<span class="w"> </span>Unable<span class="w"> </span>to<span class="w"> </span>resolve<span class="w"> </span><span class="s1">&#39;LABEL=/home&#39;</span>
</code></pre></div>
<p>我没有搞清楚这个命令到底有什么用或者应该在什么情况下使用？因为知道 LABEL 或者 UUID 并不像平常知道某一个文件那样容易记住。所以他和 find 的使用范围相比，就小了很多了，难道他有意想不到的用途？</p>
<h3 id="fixfiles">fixfiles<a class="headerlink" href="#fixfiles" title="Permanent link">&para;</a></h3>
<p>修复文件安全上下文(security contexts)。这是一个 shell 脚本，主要是用来校正文件系统上的安全上下文数据库（扩展属性）。
仔细看了帮助，也作了一些测试，没有明白他要表达什么，刚开始以为是他会恢复我原来修改过某些配置文件到初始状态，当经过测试，似乎不是这回事。
所属于 policycoreutils RPM 包，这是 SELinux 的一部分。</p>
<h3 id="fuser">fuser<a class="headerlink" href="#fuser" title="Permanent link">&para;</a></h3>
<p>使用文件或者套节字来表示识别进程。我常用的他的两个功能：查看我需要的进程和我要杀死我查到的进程。</p>
<p>比如当你想 umount 光驱的时候，结果系统提示你设备正在使用或者正忙，可是你又找不到到底谁使用了他。这个时候 fuser 可派上用场了。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># eject</span>
umount:<span class="w"> </span>/media/cdrom:<span class="w"> </span>device<span class="w"> </span>is<span class="w"> </span>busy
umount:<span class="w"> </span>/media/cdrom:<span class="w"> </span>device<span class="w"> </span>is<span class="w"> </span>busy
eject:<span class="w"> </span>unmount<span class="w"> </span>of<span class="w"> </span><span class="s1">&#39;/media/cdrom&#39;</span><span class="w"> </span>failed

<span class="c1"># fuser /mnt/cdrom</span>
/mnt/cdrom:<span class="w"> </span>4561c<span class="w"> </span>5382c

<span class="c1"># ps -ef |egrep &#39;(4561|5382)&#39; |grep -v grep</span>

root<span class="w"> </span><span class="m">4561</span><span class="w"> </span><span class="m">4227</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>:13<span class="w"> </span>pts/1<span class="w"> </span><span class="m">00</span>:00:00<span class="w"> </span>bash
root<span class="w"> </span><span class="m">5382</span><span class="w"> </span><span class="m">4561</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">21</span>:42<span class="w"> </span>pts/1<span class="w"> </span><span class="m">00</span>:00:00<span class="w"> </span>vim<span class="w"> </span>Autorun.inf
</code></pre></div>
<p>示例中，我想弹出光驱，系统告诉我设备忙着，于是采用 fuser 命令，参数是你文件或 scoket，fuser 将查出那些使用了他。</p>
<p><code>4561c,5382c</code> 表示目前用两个进程在占用着 <code>/mnt/cdrom</code>，分别是 4561,5382,进程 ID 后的字母表示占用资源的方式，有下面几种表示：</p>
<ul>
<li>c 当前路径(current directory.)我的理解是表示这个资源的占用是以文件目录方式，也就是进进入了需要释放的资源的路径，这是最常用的资源占用方式。</li>
<li>e 正在运行可执行文件（executable being run.），比如运行了光盘上的某个程序</li>
<li>f 打开文件（ open file），缺省模式下 f 忽略。</li>
<li>m mmap 文件或者共享库( mmap’ed file or shared library)</li>
<li>所以上面的例子中，虽然是开打了光盘上的 Autorun.inf 文件，但是给出的标识是 c，而不是 f。
  root 目录（root directory）.没有明白什么意思，难道是说进入了/root 这个特定目录？<br />
  .这应该是说某个进程使用了你要释放的资源的某个共享文件。</li>
</ul>
<p>在查找的同时，你还可定指定一些参数，比如</p>
<ul>
<li><code>-k</code>: 杀死这些正在访问这些文件的进程。除非使用-signal 修改信号，否则将发送 SIGKILL 信号。</li>
<li><code>-i</code>: 交互模式</li>
<li><code>-l</code>: 列出所有已知的信号名称。</li>
<li><code>-n</code>: 空间，选择不同的名字空间，可是 file,udp,tcp。默认是 file，也就是文件。</li>
<li><code>-signal</code>: 指定发送的信号，而不是缺省的 SIGKILL</li>
<li><code>-4</code>: 仅查询 IPV4 套接字</li>
<li><code>-6</code>: 仅查询 IPV6 套接字</li>
</ul>
<p>再看下面的例子</p>
<div class="highlight"><pre><span></span><code><span class="c1"># fuser -l</span>
HUP<span class="w"> </span>INT<span class="w"> </span>QUIT<span class="w"> </span>ILL<span class="w"> </span>TRAP<span class="w"> </span>ABRT<span class="w"> </span>IOT<span class="w"> </span>BUS<span class="w"> </span>FPE<span class="w"> </span>KILL<span class="w"> </span>USR1<span class="w"> </span>SEGV<span class="w"> </span>USR2<span class="w"> </span>PIPE<span class="w"> </span>ALRM<span class="w"> </span>TERM
STKFLT<span class="w"> </span>CHLD<span class="w"> </span>CONT<span class="w"> </span>STOP<span class="w"> </span>TSTP<span class="w"> </span>TTIN<span class="w"> </span>TTOU<span class="w"> </span>URG<span class="w"> </span>XCPU<span class="w"> </span>XFSZ<span class="w"> </span>VTALRM<span class="w"> </span>PROF<span class="w"> </span>WINCH<span class="w"> </span>IO<span class="w"> </span>PWR<span class="w"> </span>SYS
UNUSED
</code></pre></div>
<p>现在我们试试 fuser -k 的威力：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># fuser -k /mnt/cdrom</span>
/mnt/cdrom:<span class="w"> </span>4561c<span class="w"> </span>5382c

<span class="nb">kill</span><span class="w"> </span><span class="m">5382</span>:<span class="w"> </span>没有那个进程
No<span class="w"> </span>automatic<span class="w"> </span>removal.<span class="w"> </span>Please<span class="w"> </span>use<span class="w"> </span>umount<span class="w"> </span>/media/cdrom

<span class="c1"># eject</span>
</code></pre></div>
<p>套节字方式的使用：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># fuser -4 -n tcp 3306</span>
here:<span class="w"> </span><span class="m">3306</span>
<span class="m">3306</span>/tcp:<span class="w"> </span><span class="m">5595</span>

<span class="c1"># ps -ef |grep 5595 |grep -v grep</span>

mysql<span class="w"> </span><span class="m">5595</span><span class="w"> </span><span class="m">5563</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">22</span>:24<span class="w"> </span>pts/0<span class="w"> </span><span class="m">00</span>:00:00<span class="w"> </span>/usr/libexec/mysqld<span class="w"> </span>–defaults-file<span class="o">=</span>/etc/my.cnf<span class="w"> </span>–basedir<span class="o">=</span>/usr<span class="w"> </span>–datadir<span class="o">=</span>/var/lib/mysql<span class="w"> </span>–user<span class="o">=</span>mysql<span class="w"> </span>–pid-file<span class="o">=</span>/var/run/mysqld/mysqld.pid<span class="w"> </span>–skip-locking<span class="w"> </span>–socket<span class="o">=</span>/var/lib/mysql/mysql.sock


<span class="c1"># fuser -4 -n tcp 80</span>
here:<span class="w"> </span><span class="m">80</span>
<span class="m">80</span>/tcp:<span class="w"> </span><span class="m">5685</span><span class="w"> </span><span class="m">5688</span><span class="w"> </span><span class="m">5689</span><span class="w"> </span><span class="m">5690</span><span class="w"> </span><span class="m">5691</span><span class="w"> </span><span class="m">5692</span><span class="w"> </span><span class="m">5693</span><span class="w"> </span><span class="m">5694</span><span class="w"> </span><span class="m">5695</span>
</code></pre></div>
<h3 id="fxload">fxload<a class="headerlink" href="#fxload" title="Permanent link">&para;</a></h3>
<p>为 EZ-USB 设别下载 firmware。</p>
<h2 id="sbin-g">/sbin 下 g 开头的命令：<a class="headerlink" href="#sbin-g" title="Permanent link">&para;</a></h2>
<blockquote>
<p>generate-modprobe.conf getkey grub grub-install grub-terminfo genhostid
getmd grubby grub-md5-crypt</p>
</blockquote>
<h3 id="generate-modprobeconf">generate-modprobe.conf<a class="headerlink" href="#generate-modprobeconf" title="Permanent link">&para;</a></h3>
<p>将原来的 module.conf 文件迁移到 modprobe.conf 文件。这是 2.4 内核到 2.6 内核后驱动模块配置的一个改变。</p>
<h3 id="getkey">getkey<a class="headerlink" href="#getkey" title="Permanent link">&para;</a></h3>
<p>在指定的时间内等待按键，默认时间单位是秒。比如：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># getkey -c 5 -m &quot;Please input a number within 5s[%d]:&quot;</span>
Please<span class="w"> </span>input<span class="w"> </span>a<span class="w"> </span>number<span class="w"> </span>within<span class="w"> </span>5s<span class="o">[</span><span class="m">5</span><span class="o">]</span>
</code></pre></div>
<p>后面的<code>[]</code>内的时间是变化的。</p>
<h3 id="grub">grub<a class="headerlink" href="#grub" title="Permanent link">&para;</a></h3>
<p>grub, grub-install ,grub-terminfo, grub-md5-crypt,grubby 这这些命令都是和 grub 有关的。</p>
<h3 id="genhostid">genhostid<a class="headerlink" href="#genhostid" title="Permanent link">&para;</a></h3>
<p>随机生成一个 hostid 号，如果 <code>/etc/hostid</code> 不存在的话，他和我们通常使用的 hostid(1)有些微妙的关系。</p>
<p>如果 <code>/etc/hostid</code> 文件不存在，则 hostid 命令打印出当前机器的标志号，只要你的机器硬件设备没有更换，这个 ID 号就不会改变，很多情况下这个号码和你的网卡有一定的关系。  </p>
<p>于是在 Linux 下，很多软件的授权号码就于 hostid 有关系，因为不同的机器 hostid 不同，这样能保证只有授权的机器才能安装对应的软件。  </p>
<p>但是如果 <code>/etc/hostid</code> 文件存在, hostid 命令则只是打印出该号码，而 <code>/etc/hostid</code> 的生成就是依赖 genhostid 命令。  </p>
<p>但是我刚才说了，genhostid 是随机产生一个 hostid 号。
因此如果你希望 hostid 命令每次得到不同的结果，那么你就应该每次都重新生成 /etc/hostid 文件。不过要注意的是 hostid 命令生成的 hostid 号只有 6 位，而 genhostid 产生的是 8 位。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># hostid</span>
7f0100

<span class="c1"># genhostid</span>
<span class="c1"># hostid</span>
804937a4

<span class="c1"># rm -f /etc/hostid</span>
<span class="c1"># hostid</span>
7f0100

<span class="c1"># genhostid</span>
<span class="c1"># hostid</span>
106a8419

<span class="c1"># hexdump /etc/hostid</span>
<span class="m">0000000</span><span class="w"> </span><span class="m">8419</span><span class="w"> </span>106a
<span class="m">0000004</span>
</code></pre></div>
<p>从 hexdump 命令的结果来看，<code>/etc/hostid</code> 文件结构似乎很简单，我们尝试获得一个我们需要的“随机”hostid 号试试。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// myhostid.c</span>
<span class="cp">#include</span>
<span class="cp">#include</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">fd1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="err">×</span><span class="mi">12345678</span><span class="p">;</span><span class="w"> </span><span class="c1">//my hostid</span>
<span class="w">    </span><span class="n">fd1</span><span class="o">=</span><span class="n">open</span><span class="p">(</span><span class="err">“</span><span class="n">hostid</span><span class="err">”</span><span class="p">,</span><span class="n">O_CREAT</span><span class="o">|</span><span class="n">O_WRONLY</span><span class="p">,</span><span class="mo">0220</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">fd1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">perror</span><span class="p">(</span><span class="err">“</span><span class="n">error</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="err">“</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">65</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">write</span><span class="p">(</span><span class="n">fd1</span><span class="p">,</span><span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">a</span><span class="p">));</span>
<span class="w">    </span><span class="n">close</span><span class="p">(</span><span class="n">fd1</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># gcc myhostid.c -o myhostid</span>
<span class="c1"># ./myhostid</span>

<span class="c1"># #cp -f hostid /etc/hostid</span>
<span class="c1"># hostid</span>
d2bdd8ed

<span class="c1"># cp -f hostid /etc/hostid</span>
<span class="c1"># hostid</span>
<span class="m">12345678</span>
</code></pre></div>
<h3 id="getmd">getmd<a class="headerlink" href="#getmd" title="Permanent link">&para;</a></h3>
<p>分析<code>/etc/raidtab</code>文件，它是 scsirastools 包中一个命令，这个包的主要功能就是增加一些管理 scsi 设备的命令，有下面一些：</p>
<ul>
<li><code>sgdskfl</code>:   to load disk firmware to disks under Linux  </li>
<li><code>sgmode</code>:   to get and set SCSI mode pages  </li>
<li><code>sgdefects</code>:   to read the primary and grown defect lists  </li>
<li><code>sgdiag</code>:   to perform format &amp; other test functions  </li>
<li><code>sgraidmon</code>:   to monitor software RAID disks for hot-insertion/removal  </li>
<li><code>getmd</code>:   to parse /etc/raidtab for devices (used in mdmon only)  </li>
<li><code>mdadm</code>:   to administer the md raid configuration  </li>
<li><code>alarms</code>:   to set disk fault LEDs on mBMC platforms</li>
</ul>
<h2 id="sbin-h">/sbin 下 h 开头的命令<a class="headerlink" href="#sbin-h" title="Permanent link">&para;</a></h2>
<h3 id="halt">halt<a class="headerlink" href="#halt" title="Permanent link">&para;</a></h3>
<p>停止系统，他和 reboot，poweroff 等命令属于同一个功能集。</p>
<p>halt 命令不不接参数，仅仅有几个选项来决定如何停止系统</p>
<ul>
<li><code>-n</code>: 停止系统前不做同步(sync)，适合快速关机和那些仅仅只有只读访问的系统。  </li>
<li><code>-w</code>: 仅在 wtmp 文件中写一条 reboot 记录，然后退出，他的用处是什么？  </li>
<li><code>-d</code>: 不写 reboot 记录到 wtmp 文件中  </li>
<li><code>-f</code>: 强制停机/重启，但不调用 shutdown.shutdown 是一种安全的关闭系统的方式。  </li>
<li><code>-p</code>: 如果支持，系统关闭后掉电。否则只是停止系统.</li>
</ul>
<h3 id="hdparm">hdparm<a class="headerlink" href="#hdparm" title="Permanent link">&para;</a></h3>
<p>获取和设置硬盘参数，当我一次看到 hdparm 命令和其说明时，我以为我发现了一个秘笈，因为说明中提到，他可以设置一些关键的参数，让你的硬盘提速。
同时在网上也找到了不少有关这个命令的介绍，大多数都说可以显著提高硬盘响应速度，还有很多人的标题干脆是“瞬间提高你的 Linux 的速度”。
其实大部分介绍中，主要是修改两个参数，一个是设置 DMA 为 enable，另外一个是设置 I/0 为 32 位。<br />
我测试过这两个参数，对硬盘的响应速度确实有很大的影响，特别是 DMA 的设置，有相差好几倍的效果。  </p>
<p>然后实际上，后来的 Linux 分发版本，对于硬盘的优化早在系统启动中就已经做好了。  </p>
<p>而我知道的是，仅仅只有 2.2 的内核默认是不打开 DMA 模式的，因此在 2.2 的内核，利用<code>hdparm -c 1 /dev/hdx</code>的方式来提高硬盘响应速度是有效果的，但是 2.2 的内核毕竟是古董了。  </p>
<p>另外 hdparm 的 man 提到 hdparm 仅仅只是设置 ATA/IDE 硬盘参数，而对 SCSI 硬盘是没有用的，当然也对后来出现的 SATA,SAS 硬盘无效了。 
我没有测试过 SCSI 硬盘，也没有测试过 SATA,SAS 硬盘，所以现在还不能给出一个确切的答案。</p>
<p>我们看看后来的 linux 版本是如何在启动是针对不同硬盘做的优化的，下面的脚本片段来自 <code>/etc/rc.d/rc.sysinit</code> 文件</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Turn on harddisk optimization</span>
<span class="c1"># There is only one file /etc/sysconfig/harddisks for all disks</span>
<span class="c1"># after installing the hdparm-RPM. If you need different hdparm parameters</span>
<span class="c1"># for each of your disks, copy /etc/sysconfig/harddisks to</span>
<span class="c1"># /etc/sysconfig/harddiskhda (hdb, hdc…) and modify it.</span>
<span class="c1"># Each disk which has no special parameters will use the defaults.</span>
<span class="c1"># Each non-disk which has no special parameters will be ignored.</span>
<span class="c1">#</span>

disk<span class="o">[</span><span class="m">0</span><span class="o">]=</span>s<span class="p">;</span>
disk<span class="o">[</span><span class="m">1</span><span class="o">]=</span>hda<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">2</span><span class="o">]=</span>hdb<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">3</span><span class="o">]=</span>hdc<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">4</span><span class="o">]=</span>hdd<span class="p">;</span>
disk<span class="o">[</span><span class="m">5</span><span class="o">]=</span>hde<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">6</span><span class="o">]=</span>hdf<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">7</span><span class="o">]=</span>hdg<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">8</span><span class="o">]=</span>hdh<span class="p">;</span>
disk<span class="o">[</span><span class="m">9</span><span class="o">]=</span>hdi<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">10</span><span class="o">]=</span>hdj<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">11</span><span class="o">]=</span>hdk<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">12</span><span class="o">]=</span>hdl<span class="p">;</span>
disk<span class="o">[</span><span class="m">13</span><span class="o">]=</span>hdm<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">14</span><span class="o">]=</span>hdn<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">15</span><span class="o">]=</span>hdo<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">16</span><span class="o">]=</span>hdp<span class="p">;</span>
disk<span class="o">[</span><span class="m">17</span><span class="o">]=</span>hdq<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">18</span><span class="o">]=</span>hdr<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">19</span><span class="o">]=</span>hds<span class="p">;</span><span class="w"> </span>disk<span class="o">[</span><span class="m">20</span><span class="o">]=</span>hdt<span class="p">;</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-x<span class="w"> </span>/sbin/hdparm<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>device<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">17</span><span class="w"> </span><span class="m">18</span><span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">20</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nb">unset</span><span class="w"> </span>MULTIPLE_IO<span class="w"> </span>USE_DMA<span class="w"> </span>EIDE_32BIT<span class="w"> </span>LOOKAHEAD<span class="w"> </span>EXTRA_PARAMS
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span>/etc/sysconfig/harddisk<span class="si">${</span><span class="nv">disk</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span>.<span class="w"> </span>/etc/sysconfig/harddisk<span class="si">${</span><span class="nv">disk</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span>
<span class="w">            </span>HDFLAGS<span class="o">[</span><span class="nv">$device</span><span class="o">]=</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span>“<span class="nv">$MULTIPLE_IO</span>”<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span>HDFLAGS<span class="o">[</span><span class="nv">$device</span><span class="o">]=</span>”-q<span class="w"> </span>-m<span class="nv">$MULTIPLE_IO</span>”
<span class="w">            </span><span class="k">fi</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span>“<span class="nv">$USE_DMA</span>”<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span>HDFLAGS<span class="o">[</span><span class="nv">$device</span><span class="o">]=</span>”<span class="si">${</span><span class="nv">HDFLAGS</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span><span class="w"> </span>-q<span class="w"> </span>-d<span class="nv">$USE_DMA</span>”
<span class="w">            </span><span class="k">fi</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span>“<span class="nv">$EIDE_32BIT</span>”<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span>HDFLAGS<span class="o">[</span><span class="nv">$device</span><span class="o">]=</span>”<span class="si">${</span><span class="nv">HDFLAGS</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span><span class="w"> </span>-q<span class="w"> </span>-c<span class="nv">$EIDE_32BIT</span>”
<span class="w">            </span><span class="k">fi</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span>“<span class="nv">$LOOKAHEAD</span>”<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span>HDFLAGS<span class="o">[</span><span class="nv">$device</span><span class="o">]=</span>”<span class="si">${</span><span class="nv">HDFLAGS</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span><span class="w"> </span>-q<span class="w"> </span>-A<span class="nv">$LOOKAHEAD</span>”
<span class="w">            </span><span class="k">fi</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span>“<span class="nv">$EXTRA_PARAMS</span>”<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span>HDFLAGS<span class="o">[</span><span class="nv">$device</span><span class="o">]=</span>”<span class="si">${</span><span class="nv">HDFLAGS</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span><span class="w"> </span><span class="nv">$EXTRA_PARAMS</span>”
<span class="w">            </span><span class="k">fi</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span>HDFLAGS<span class="o">[</span><span class="nv">$device</span><span class="o">]=</span>”<span class="si">${</span><span class="nv">HDFLAGS</span><span class="p">[0]</span><span class="si">}</span>”
<span class="w">        </span><span class="k">fi</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-e<span class="w"> </span>“/proc/ide/<span class="si">${</span><span class="nv">disk</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span>/media”<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="nv">hdmedia</span><span class="o">=</span><span class="sb">`</span>cat<span class="w"> </span>/proc/ide/<span class="si">${</span><span class="nv">disk</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span>/media<span class="sb">`</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>“<span class="nv">$hdmedia</span>”<span class="w"> </span><span class="o">=</span><span class="w"> </span>“disk”<span class="w"> </span>-o<span class="w"> </span>-f<span class="w"> </span>“/etc/sysconfig/harddisk<span class="si">${</span><span class="nv">disk</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span>”<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span>“<span class="si">${</span><span class="nv">HDFLAGS</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span>”<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span>action<span class="w"> </span>$”Setting<span class="w"> </span>hard<span class="w"> </span>drive<span class="w"> </span>parameters<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="si">${</span><span class="nv">disk</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span>:<span class="w"> </span>”<span class="w"> </span><span class="se">\</span>
<span class="w">                        </span>/sbin/hdparm<span class="w"> </span><span class="si">${</span><span class="nv">HDFLAGS</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span><span class="w"> </span>/dev/<span class="si">${</span><span class="nv">disk</span><span class="p">[</span><span class="nv">$device</span><span class="p">]</span><span class="si">}</span>
<span class="w">                </span><span class="k">fi</span>
<span class="w">            </span><span class="k">fi</span>
<span class="w">        </span><span class="k">fi</span>
<span class="w">    </span><span class="k">done</span>
<span class="k">fi</span>
</code></pre></div>
<p>这段脚本是所有的 IDE 硬盘，根据 <code>/etc/sysconfig/harddisks</code> 文件的策略而设置硬盘的参数. 
从这里我们似乎可以看出，sdx 设备并不再设置之内，由此是不是可以肯定 hdparm 对 SCSI 设备不支持呢？
我们再看看 harddisks 文件</p>
<div class="highlight"><pre><span></span><code><span class="c1">#</span>
<span class="c1"># WARNING !!!</span>
<span class="c1">#</span>
<span class="c1"># The kernel will autodetect the correct settings for most drives.</span>
<span class="c1"># Overriding these settings with hdparm can cause data corruption and/or</span>
<span class="c1"># data loss.</span>
<span class="c1"># Leave this file as it is unless you know exactly what you&#39;re doing !!</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># These options are used to tune the hard drives -</span>
<span class="c1"># read the hdparm man page for more information</span>

<span class="c1"># Set this to 1 to enable DMA. This might cause some</span>
<span class="c1"># data corruption on certain chipset / hard drive</span>
<span class="c1"># combinations. This is used with the “-d” option</span>

<span class="c1"># USE_DMA=1</span>

<span class="c1"># Multiple sector I/O. a feature of most modern IDE hard drives,</span>
<span class="c1"># permitting the transfer of multiple sectors per I/O interrupt,</span>
<span class="c1"># rather than the usual one sector per interrupt. When this feature</span>
<span class="c1"># is enabled, it typically reduces operating system overhead for disk</span>
<span class="c1"># I/O by 30-50%. On many systems, it also provides increased data</span>
<span class="c1"># throughput of anywhere from 5% to 50%. Some drives, however (most</span>
<span class="c1"># notably the WD Caviar series), seem to run slower with multiple mode</span>
<span class="c1"># enabled. Under rare circumstances, such failures can result in</span>
<span class="c1"># massive filesystem corruption. USE WITH CAUTION AND BACKUP.</span>
<span class="c1"># This is the sector count for multiple sector I/O – the “-m” option</span>
<span class="c1">#</span>
<span class="c1"># MULTIPLE_IO=16</span>

<span class="c1"># (E)IDE 32-bit I/O support (to interface card)</span>
<span class="c1">#</span>
<span class="c1"># EIDE_32BIT=3</span>

<span class="c1"># Enable drive read-lookahead</span>
<span class="c1">#</span>
<span class="c1"># LOOKAHEAD=1</span>

<span class="c1"># Add extra parameters here if wanted</span>
<span class="c1"># On reasonably new hardware, you may want to try -X66, -X67 or -X68</span>
<span class="c1"># Other flags you might want to experiment with are -u1, -a and -m</span>
<span class="c1"># See the hdparm manpage (man hdparm) for details and more options.</span>
<span class="c1">#</span>
<span class="na">EXTRA_PARAMS</span><span class="o">=</span>
</code></pre></div>
<p>从这个文件的注释我们能够看出，它将影响硬盘效果最明显的参数单独列了出来，而将其他参数放到了 EXTRA_PARAMS 里。  </p>
<p>因此对于 hdparm 命令的众多参数而言，我们需要去了解的不太多。  </p>
<h3 id="hotplug">hotplug<a class="headerlink" href="#hotplug" title="Permanent link">&para;</a></h3>
<p>Linux 下热插拔支持脚本。  </p>
<h3 id="hwclock">hwclock<a class="headerlink" href="#hwclock" title="Permanent link">&para;</a></h3>
<p>查询和设置硬件时钟(RTC).系统启动时，需要从硬件时钟中读出时间来设置系统系统，这个过程在<code>/etc/rc.d/rc.sysinit</code> 脚本中采用<code>hwclock $CLOCKFLAGS</code>的方式来实现。</p>
<p>这里的参数 <code>$CLOCKFLAGS</code> 分为两部分，一部分是 <code>--hctosys</code>,表示同步的方式是硬件时钟到系统时钟。另外一部分参数是时间设置的标准，是标准时间（utc），还是本地时间(localtim). </p>
<p>而关闭系统时，则相反，似乎用 <code>-systohc</code> 的参数来将系统时钟同步到硬件时钟。</p>
<h2 id="sbin-l">/sbin/下 l 开头的命令<a class="headerlink" href="#sbin-l" title="Permanent link">&para;</a></h2>
<p>不多，列举如下：</p>
<blockquote>
<p>ldconfig lilo logsave loopctrl losetup lsmod lspci lsusb lvm lvm.static</p>
</blockquote>
<p>其中 lvm 是 lvm.static 的软连接。</p>
<h3 id="ldconfig">ldconfig<a class="headerlink" href="#ldconfig" title="Permanent link">&para;</a></h3>
<p>配置动态连接库，以便程序在编译和运行中动态连接这些程序库。与此相关的配置文件便是 <code>/etc/ld.so.conf</code>，
后来的 ldconfig 的配置文件采取了现在流行的读取目录下的配置文件。所以 <code>/etc/ld.so.conf.d</code>目录便是后来增加的。</p>
<p>我仅仅使用 ldconfig 的一个参数-f，就是指定配置文件，这样的好处是，当我需要增加某一个目录的动态库时，我不要全部重建动态库缓存，命令程序运行时间短了很多。</p>
<h3 id="lilo">lilo<a class="headerlink" href="#lilo" title="Permanent link">&para;</a></h3>
<p>grub 之前的引导程序，不知道现在还有多少发行版本使用他,留着他的一个好处是，当我丢失引导程序，而 grub 又安装不上时，lilo 这个时候就可以出马了，而 lilo 每次都没有让我失望，所以我对他的印象不错。</p>
<h3 id="logsave">logsave<a class="headerlink" href="#logsave" title="Permanent link">&para;</a></h3>
<p>日志记录程序，参数方式如下：</p>
<div class="highlight"><pre><span></span><code>logsave<span class="w"> </span><span class="o">[</span><span class="w"> </span>-asv<span class="w"> </span><span class="o">]</span><span class="w"> </span>logfile<span class="w"> </span>cmd_prog<span class="w"> </span><span class="o">[</span><span class="w"> </span>...<span class="w"> </span><span class="o">]</span>
</code></pre></div>
<ul>
<li><code>-a</code>: 是采用附加的模式写入日志文件 logfile  </li>
<li><code>-s</code>: 写日志到用户终端  </li>
<li><code>-v</code>: 就是冗余输出</li>
</ul>
<p>给我的感觉他的作用类似重定向，比如</p>
<div class="highlight"><pre><span></span><code>cmd_prog<span class="w"> </span>&gt;logfile<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</code></pre></div>
<h3 id="loopctrl">loopctrl<a class="headerlink" href="#loopctrl" title="Permanent link">&para;</a></h3>
<p>配置 isdnloop ISDN 驱动，这应该算是一个用户遗留产品。</p>
<h3 id="lsmod">lsmod<a class="headerlink" href="#lsmod" title="Permanent link">&para;</a></h3>
<p>显示目前加载的内核模块状态</p>
<h3 id="lspci">lspci<a class="headerlink" href="#lspci" title="Permanent link">&para;</a></h3>
<p>列出所有的 PCI 设备，这个命令我用得比较少</p>
<h3 id="lsusb">lsusb<a class="headerlink" href="#lsusb" title="Permanent link">&para;</a></h3>
<p>列出所有的 usb 驱动</p>
<h3 id="lvm">lvm<a class="headerlink" href="#lvm" title="Permanent link">&para;</a></h3>
<p>lvm,lvm.static 逻辑卷管理程序程序, 他其实包括了一系列的子命令，比如 </p>
<ul>
<li>pvscan</li>
<li>pvcreate</li>
<li>pvdisplay</li>
<li>vgscan</li>
<li>vgcreate</li>
<li>vgchange</li>
<li>vgdisplay</li>
<li>lvscan</li>
<li>lvcreate</li>
<li>lvdisplay </li>
</ul>
<p>等，这些子命令也可以单独使用，从一个初始的硬盘开始到创建一个可以使用的文件系统并挂载的简单步骤是:(我这里用 /dev/ram0 来替代硬盘)</p>
<div class="highlight"><pre><span></span><code><span class="c1"># pvcreate /dev/ram0</span>
Physical<span class="w"> </span>volume<span class="w"> </span>“/dev/ram0″<span class="w"> </span>successfully<span class="w"> </span>created

<span class="c1"># vgcreate vgname /dev/ram0</span>
Volume<span class="w"> </span>group<span class="w"> </span>“vgname”<span class="w"> </span>successfully<span class="w"> </span>created

<span class="c1"># vgchange -a y vgname</span>
<span class="m">0</span><span class="w"> </span>logical<span class="w"> </span>volume<span class="o">(</span>s<span class="o">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>volume<span class="w"> </span>group<span class="w"> </span>“vgname”<span class="w"> </span>now<span class="w"> </span>active

<span class="c1"># lvcreate -L20M -n lvname vgname</span>
Logical<span class="w"> </span>volume<span class="w"> </span>“lvname”<span class="w"> </span>created

<span class="c1"># mkfs.ext3 /dev/mapper/vgname-lvname</span>
mke2fs<span class="w"> </span><span class="m">1</span>.39<span class="w"> </span><span class="o">(</span><span class="m">29</span>-May-2006<span class="o">)</span>
Filesystem<span class="w"> </span><span class="nv">label</span><span class="o">=</span>
OS<span class="w"> </span>type:<span class="w"> </span>Linux
Block<span class="w"> </span><span class="nv">size</span><span class="o">=</span><span class="m">1024</span><span class="w"> </span><span class="o">(</span><span class="nv">log</span><span class="o">=</span><span class="m">0</span><span class="o">)</span>
Fragment<span class="w"> </span><span class="nv">size</span><span class="o">=</span><span class="m">1024</span><span class="w"> </span><span class="o">(</span><span class="nv">log</span><span class="o">=</span><span class="m">0</span><span class="o">)</span>
<span class="m">5136</span><span class="w"> </span>inodes,<span class="w"> </span><span class="m">20480</span><span class="w"> </span>blocks
<span class="m">1024</span><span class="w"> </span>blocks<span class="w"> </span><span class="o">(</span><span class="m">5</span>.00%<span class="o">)</span><span class="w"> </span>reserved<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>super<span class="w"> </span>user
First<span class="w"> </span>data<span class="w"> </span><span class="nv">block</span><span class="o">=</span><span class="m">1</span>
Maximum<span class="w"> </span>filesystem<span class="w"> </span><span class="nv">blocks</span><span class="o">=</span><span class="m">20971520</span>
<span class="m">3</span><span class="w"> </span>block<span class="w"> </span>groups
<span class="m">8192</span><span class="w"> </span>blocks<span class="w"> </span>per<span class="w"> </span>group,<span class="w"> </span><span class="m">8192</span><span class="w"> </span>fragments<span class="w"> </span>per<span class="w"> </span>group
<span class="m">1712</span><span class="w"> </span>inodes<span class="w"> </span>per<span class="w"> </span>group
Superblock<span class="w"> </span>backups<span class="w"> </span>stored<span class="w"> </span>on<span class="w"> </span>blocks:
<span class="m">8193</span>

Writing<span class="w"> </span>inode<span class="w"> </span>tables:<span class="w"> </span><span class="k">done</span>
Creating<span class="w"> </span>journal<span class="w"> </span><span class="o">(</span><span class="m">1024</span><span class="w"> </span>blocks<span class="o">)</span>:<span class="w"> </span><span class="k">done</span>
Writing<span class="w"> </span>superblocks<span class="w"> </span>and<span class="w"> </span>filesystem<span class="w"> </span>accounting<span class="w"> </span>information:<span class="w"> </span><span class="k">done</span>

This<span class="w"> </span>filesystem<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>automatically<span class="w"> </span>checked<span class="w"> </span>every<span class="w"> </span><span class="m">39</span><span class="w"> </span>mounts<span class="w"> </span>or
<span class="m">180</span><span class="w"> </span>days,<span class="w"> </span>whichever<span class="w"> </span>comes<span class="w"> </span>first.<span class="w"> </span>Use<span class="w"> </span>tune2fs<span class="w"> </span>-c<span class="w"> </span>or<span class="w"> </span>-i<span class="w"> </span>to<span class="w"> </span>override.

<span class="c1"># mount /dev/mapper/vgname-lvname /misc</span>

<span class="c1"># df -h</span>
文件系统<span class="w"> </span>容量<span class="w"> </span>已用<span class="w"> </span>可用<span class="w"> </span>已用%<span class="w"> </span>挂载点
/dev/hda5<span class="w"> </span><span class="m">6</span>.7G<span class="w"> </span><span class="m">2</span>.2G<span class="w"> </span><span class="m">4</span>.2G<span class="w"> </span><span class="m">35</span>%<span class="w"> </span>/
/dev/hda1<span class="w"> </span>99M<span class="w"> </span>23M<span class="w"> </span>71M<span class="w"> </span><span class="m">25</span>%<span class="w"> </span>/boot
/dev/shm<span class="w"> </span>248M<span class="w"> </span><span class="m">0</span><span class="w"> </span>248M<span class="w"> </span><span class="m">0</span>%<span class="w"> </span>/dev/shm
/dev/hda3<span class="w"> </span><span class="m">6</span>.8G<span class="w"> </span><span class="m">5</span>.3G<span class="w"> </span><span class="m">1</span>.2G<span class="w"> </span><span class="m">83</span>%<span class="w"> </span>/dc50
/dev/mapper/vgdata-data
20G<span class="w"> </span>831M<span class="w"> </span>18G<span class="w"> </span><span class="m">5</span>%<span class="w"> </span>/data
/dev/mapper/vgname-lvname
20M<span class="w"> </span><span class="m">1</span>.2M<span class="w"> </span>18M<span class="w"> </span><span class="m">7</span>%<span class="w"> </span>/misc
</code></pre></div>
<h2 id="sbin-m">/sbin 目录下 m 开头的命令<a class="headerlink" href="#sbin-m" title="Permanent link">&para;</a></h2>
<p>可不少</p>
<div class="highlight"><pre><span></span><code>mdadm<span class="w">          </span>mii-tool<span class="w">    </span>mkfs.cramfs<span class="w">    </span>mkfs.xfs<span class="w">    </span>mounted.ocfs2<span class="w">  </span>mpath_get_name<span class="w">          </span>multipath.static
mdadm.static<span class="w">   </span>mingetty<span class="w">    </span>mkfs.ext2<span class="w">      </span>mkinitrd<span class="w">    </span>mount.ncp<span class="w">      </span>mpath_prio_alua
mdassemble<span class="w">     </span>minilogd<span class="w">    </span>mkfs.ext3<span class="w">      </span>mkreiserfs<span class="w">  </span>mount.ncpfs<span class="w">    </span>mpath_prio_emc
mdevt<span class="w">          </span>mkbootdisk<span class="w">  </span>mkfs.msdos<span class="w">     </span>mkswap<span class="w">      </span>mount.ocfs2<span class="w">    </span>mpath_prio_hds_modular
mdmpd<span class="w">          </span>mkdosfs<span class="w">     </span>mkfs.ocfs2<span class="w">     </span>mkzonedb<span class="w">    </span>mount.smb<span class="w">      </span>mpath_prio_netapp
mgetty<span class="w">         </span>mke2fs<span class="w">      </span>mkfs.reiserfs<span class="w">  </span>modinfo<span class="w">     </span>mount.smbfs<span class="w">    </span>multipath
microcode_ctl<span class="w">  </span>mkfs<span class="w">        </span>mkfs.vfat<span class="w">      </span>modprobe<span class="w">    </span>mpath_ctl<span class="w">      </span>multipathd
</code></pre></div>
<p>mkfs 系列命令占了很大一部分。 </p>
<h3 id="mdadm">mdadm<a class="headerlink" href="#mdadm" title="Permanent link">&para;</a></h3>
<p>mdadm, mdadm.static 这是和 RAID 相关的程序，他用来管理 Linux 下的软 RAID。</p>
<p>当前 Linux 提供的 RAID 级别有 </p>
<ul>
<li>LINEAR md 设备</li>
<li>RAID0 (striping)</li>
<li>RAID1 (mirroring)</li>
<li>RAID4</li>
<li>RAID5</li>
<li>RAID6</li>
<li>MULTIPATH</li>
<li>FAULTY</li>
</ul>
<p>这里说的 multipath 其实并不是软 RAID 机制中的一部分，但是他会去调用。</p>
<h3 id="mdmpd">mdmpd<a class="headerlink" href="#mdmpd" title="Permanent link">&para;</a></h3>
<p>监控 MD multipath 设备的 daemon 程序。  </p>
<h3 id="mii-tool">mii-tool<a class="headerlink" href="#mii-tool" title="Permanent link">&para;</a></h3>
<p>查看，管理独立介质接口状态，这是一个过时的程序了，目前代替他功能的程序是 eth-tool。  </p>
<h3 id="mkbootdisk">mkbootdisk<a class="headerlink" href="#mkbootdisk" title="Permanent link">&para;</a></h3>
<p>制作启动磁盘，不知道现在还有多少人使用他，现在看到的服务器似乎都没有软驱了。  </p>
<h3 id="mkfs">mkfs.*：<a class="headerlink" href="#mkfs" title="Permanent link">&para;</a></h3>
<p>这是制作文件系统的程序集，如果什么都不考虑，仅仅是制作文件系统的话，那直接 mkfs 了。但是如果你要从存储数据的性质，读写速度，存放文件个数等方面着想，那就不得不考虑 mkfs 命令集的一些参数了。</p>
<h3 id="mkinitrd">mkinitrd<a class="headerlink" href="#mkinitrd" title="Permanent link">&para;</a></h3>
<p>重做镜像文件，这个命令在更新了一些核心驱动模块的时候，用得着。
比如更新了 SCSI 卡的驱动，增加驱动模块的一些参数等，一般来说，如果修改了<code>/etc/modprobe.conf</code> 中块设备文件的配置参数，就应该重新制作镜像文件，</p>
<p>方法倒是很简单 </p>
<div class="highlight"><pre><span></span><code>mkinitrd<span class="w"> </span>/boot/newinitrd.img<span class="w"> </span><span class="sb">`</span>uname<span class="w"> </span>-r<span class="sb">`</span>
</code></pre></div>
<h3 id="modinfo">modinfo<a class="headerlink" href="#modinfo" title="Permanent link">&para;</a></h3>
<p>显示内核模块的一些信息，包括作者，描述，授权方式，核心参数等，其中有的还包括了模块依赖性的描述，比如:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># modinfo e100.ko</span>
filename:<span class="w">       </span>/lib/modules/2.6.9-42.7AX/kernel/drivers/net/e100.ko
description:<span class="w">    </span>Intel<span class="o">(</span>R<span class="o">)</span><span class="w"> </span>PRO/100<span class="w"> </span>Network<span class="w"> </span>Driver
author:<span class="w">         </span>Copyright<span class="o">(</span>c<span class="o">)</span><span class="w"> </span><span class="m">1999</span>-2005<span class="w"> </span>Intel<span class="w"> </span>Corporation
license:<span class="w">        </span>GPL
version:<span class="w">        </span><span class="m">3</span>.5.10-k2-NAPI<span class="w"> </span>6481838CE42D9570A7D35AF
parm:<span class="w">           </span>debug:Debug<span class="w"> </span>level<span class="w"> </span><span class="o">(</span><span class="nv">0</span><span class="o">=</span>none,...,16<span class="o">=</span>all<span class="o">)</span>
vermagic:<span class="w">       </span><span class="m">2</span>.6.9-42.7AX<span class="w"> </span><span class="m">686</span><span class="w"> </span>REGPARM<span class="w"> </span>4KSTACKS<span class="w"> </span>gcc-3.4
depends:<span class="w">        </span>mii
alias:<span class="w">          </span>pci:v00008086d00001029sv*sd*bc02sc00i*
alias:<span class="w">          </span>pci:v00008086d00001030sv*sd*bc02sc00i*
alias:<span class="w">          </span>pci:v00008086d00001031sv*sd*bc02sc00i*
alias:<span class="w">          </span>pci:v00008086d00001032sv*sd*bc02sc00i*
alias:<span class="w">          </span>pci:v00008086d00001033sv*sd*bc02sc00i*
alias:<span class="w">          </span>pci:v00008086d00001034sv*sd*bc02sc00i*
.........................................
</code></pre></div>
<p>从这个命令的输出我们可以看出 <code>e100.ko</code> 这个模块目前的版本是 3.5.10，他依赖模块 <code>mii.ko</code>，同时，可以传递一个参数 debug，用于调试。</p>
<h3 id="mount">mount.*<a class="headerlink" href="#mount" title="Permanent link">&para;</a></h3>
<p>文件系统挂载命令，这些命令的前端程序就是 mount,类似 mkfs 一样。  </p>
<p>这个命令恐怕是 linux 下最常用的命令之一了。所以大家都比较熟悉，我这里仅仅记录几个平常不怎么常用的几个参数</p>
<p><strong>重新挂载为只读(可写)</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># mount hd /misc -oloop</span>
<span class="c1"># touch /misc/one</span>
<span class="c1"># ls /misc</span>
lost+found<span class="w">  </span>one
<span class="c1"># mount -o remount,ro hd /misc -oloop</span>
<span class="c1"># touch /misc/two</span>
touch:<span class="w"> </span>cannot<span class="w"> </span>touch<span class="w"> </span><span class="sb">`</span>/misc/two<span class="err">&#39;</span>:<span class="w"> </span>Read-only<span class="w"> </span>file<span class="w"> </span>system
</code></pre></div>
<p><strong>猜测某个文件系统的类型</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># mount --guess-fs /dev/hda3</span>
ext3
</code></pre></div>
<h2 id="sbin-n">/sbin 下 n 开头的命令<a class="headerlink" href="#sbin-n" title="Permanent link">&para;</a></h2>
<p>不多，而且基本上不常用</p>
<blockquote>
<p>nameif nash netplugd netreport new-kernel-pkg nologin</p>
</blockquote>
<h3 id="nameif">nameif<a class="headerlink" href="#nameif" title="Permanent link">&para;</a></h3>
<p>基于 MAC 地址命名网络接口，他需要的配置文件是 <code>/etc/mactab</code>。</p>
<h3 id="nash">nash<a class="headerlink" href="#nash" title="Permanent link">&para;</a></h3>
<p>另外一种 shell，主要用在引导镜像中的脚本中，比如<code>initrd.img</code>。</p>
<h3 id="netplugd">netplugd<a class="headerlink" href="#netplugd" title="Permanent link">&para;</a></h3>
<p>网络热插拔管理后台程序。</p>
<h3 id="new-kernel-pkg">new-kernel-pkg<a class="headerlink" href="#new-kernel-pkg" title="Permanent link">&para;</a></h3>
<p>安装新内核，他能完成的功能有：  </p>
<ol>
<li>创建，删除一个 initrd  </li>
<li>运行 depmod 或者删除 depmod 生成的文件  </li>
<li>从 grub/lilo 配置文件中增加或者删除一个内核镜像（通过 grubby）。</li>
</ol>
<h3 id="nolog">nolog<a class="headerlink" href="#nolog" title="Permanent link">&para;</a></h3>
<p>想拒绝一个帐号登录，就可以使用他了，man 手册中描述的是优雅的拒绝用户登录。</p>
<p>跳过 o 开头的命令是因为 o 开头只有三个命令，而且都是和 Oracle 的 ocfs 有关，所以这里就不研究了。</p>
<h2 id="sbinp">/sbin/p 开头的命令<a class="headerlink" href="#sbinp" title="Permanent link">&para;</a></h2>
<p>p 开头的命令不少，近 20 个。</p>
<h3 id="pack_cis">pack_cis<a class="headerlink" href="#pack_cis" title="Permanent link">&para;</a></h3>
<p>与 PCMCIA 有关，编译 PCMCIA 卡信息结构。</p>
<h3 id="pam_cosonle_apply">pam_cosonle_apply<a class="headerlink" href="#pam_cosonle_apply" title="Permanent link">&para;</a></h3>
<p>在系统终端上，针对用户设置或者收回权限。他是 PAM 相关的工具。</p>
<p>如果<code>/var/run/console.lock</code>存在，则针对该文件的用户授权;如果没有，则根据缺省文件
<code>/etc/security/console.perms</code>的规则来授权。  </p>
<p>这个命令以及<code>pam_timestamp_check</code>,<code>pam_tally</code>都属于 PAM 程序</p>
<h3 id="pam_console_setowner">pam_console_setowner<a class="headerlink" href="#pam_console_setowner" title="Permanent link">&para;</a></h3>
<p>设置 console 的属主，他属于 UDEV 包.</p>
<h3 id="parted">parted<a class="headerlink" href="#parted" title="Permanent link">&para;</a></h3>
<p>强大的磁盘管理工具，类似 fdisk 功能，但是个人觉得其功能比 fdisk 强大。
其中值得说的一点就是在已经占用的磁盘上进行操作，不需要重启生效，这点就比 fdisk 强。比如你的 hda 已经在使用了（你的根文件系统），这时你希望在 hda 上再创建一个分区，如果使用 fdisk 工具，保存的时候肯定会提示要你重启才生效，因为设备 busy。
但是 parted 却不会。
另外一点是 fdisk 程序只有在你输入 <code>w</code> 命令后，所有的命令才真实生效，而 parted 不是这样，执行后，立刻生效（也许我还没有找到 undo 的功能），所以这点要注意。</p>
<p>发现一个有意思的现象：addpart，delpart 的功能是删除分区和增加分区，那么很自然的应该属于 parted 程序的功能，因此按理，这两个命令连带 partprobe 和 parted 属于同一个包。
但事实是 addpart,delpart 属于 util-linux 包。不知道为什么要这么来归类？</p>
<p>Linux 下没有图形化的磁盘管理工具一直是普通用户抱怨的地方，因为不要期望所有人都来使用 fdisk，parted 这样的命令。不过现在好了，给予 parted 的<a href="http://qtparted.sf.net">qtparted</a>就是一个 GUI 的程序。</p>
<h3 id="partx">partx<a class="headerlink" href="#partx" title="Permanent link">&para;</a></h3>
<p>partx 同样属于 parted 的包，而是 linux-util,虽然长像 parted 之类的。这个命令和 addpart，delpart 一样，没有 man 手册，没有 info 信息，没有 <code>--help</code>。</p>
<p>只好找 google，得到这个这么<a href="http://www.ussg.iu.edu/hypermail/linux/kernel/0003.2/1887.html">一篇文章</a>。可以看看。</p>
<h3 id="pivot_root">pivot_root<a class="headerlink" href="#pivot_root" title="Permanent link">&para;</a></h3>
<p>改变根文件系统。他的基本用法是：<code>pivot_root new_root put_old</code>  </p>
<p>表示把当前处理的根文件系统移到<code>put_old</code>目录，然后把<code>new_root</code>作为当前的根文件系统。  </p>
<p>这个命令更多的时候用在系统启动时。我们知道现在的 Linux 启动时，都需要一个 initrd 的核心参数，这个 initrd 后面接着的压缩文件很多情况下就是一个文件系统。  </p>
<p>内核引导后，会首先把 initrd 的参数挂载，把他当成根文件系统，处理完必要的事务后，再把核心参数 root 置顶的设备挂载上来，然后使用<code>pivot_root</code>命令切换整个根文件系统，
接着执行/sbin/init 程序来继续引导系统。</p>
<p>LSB 的 linux 发行版本，引导时会把 initrd 镜像挂载到 <code>/initrd</code> 目录下。所以你会发现根目录下有一个 initrd 目录，但是他是空的，如果我删除他，系统引导的时候就会报错，我怎么知道的？因为我干过这样的傻事。</p>
<p>man 手册中举了几个例子，可以进一步解释<code>pivot_root</code>的作用。不过对于改变根文件系统，我们可能首先想到的是 chroot，chroot 似乎也有这个功能，那么他和<code>pivot_root</code>有什么差别呢？<br />
主要的差别是<code>pivot_root</code>有意识的切换一个完整的系统到新的根目录，然后可以移走之前需要依赖的老的系统，因此你可以 umount 掉之前的根文件系统，就当做之前没有发生过原来它是运行的操作系统一样。</p>
<p>而 chroot 则有意识的申请一个单独进程的全部生命周期，他和系统的其他部分一起在老的根目录下一起运行，当 chrooted 进程退出后，系统不会发生改变。</p>
<p>注：不建议大家测试这个命令，这时我测试后得出的结果。至少我做完后，我是靠重启系统来恢复原状的(真实原因是对这个命令还是了解得不太多。)</p>
<h3 id="portmap">portmap<a class="headerlink" href="#portmap" title="Permanent link">&para;</a></h3>
<p>DARPA(美国国防部高级研究计划局)端口到 RPC 程序号的映射。也就是提供把 RPC 程序号转换成 DARPA 协议端口的服务。更统属的称呼应该就是端口映射(谁关心到底从什么协议转什么协议呢？)。 </p>
<p>当一个 RPC 服务开始时，它告诉 portmap 它将侦听哪个端口号，以及它准备为什么 RPC 程序号提供服务。<br />
但一个客户端希望对指定的程序号做 RPC 调用时，他将首先链接服务器上的 portmap 程序(服务)来决定 RPC 包应该发往哪个端口。<br />
portmap 应该在 RPC 服务调用之前启动。  </p>
<p>典型的应用应该是 NFS 了。运行一个 NFS 服务当前需要启动的服务有：portmap，nfs 和 nfslock。不启动 portmap 而单独启动 nfs， fslock 服务提供 NFS 服务时，我遇到过两种错误：</p>
<ol>
<li>非常长的时间才能 mount 上  </li>
<li>直接报给出的服务不可用。</li>
</ol>
<h3 id="sbin-q">/sbin 下的 q 开头的命令<a class="headerlink" href="#sbin-q" title="Permanent link">&para;</a></h3>
<p>只有两个，quotacheck 和 quotaon，其中 quotaoff 是 quotaon 的软连接。</p>
<p>这是和磁盘配额有关的命令，详细情况可以参考 Linux 下的配额配置手册。</p>
<h3 id="sbin-r">/sbin 下 r 开头的命令<a class="headerlink" href="#sbin-r" title="Permanent link">&para;</a></h3>
<p>稍微多些，有 25 个，不过有 7 个是软连接。</p>
<h3 id="restore">restore<a class="headerlink" href="#restore" title="Permanent link">&para;</a></h3>
<p>从 dump 出来的备份恢复到文件系统中，我仅测试了一个例子，看上去一切正常，不过从这个例子。如果不考虑一些特别因素，那么 dump/restore 的使用方法是很简单的，下面是我测试的例子</p>
<div class="highlight"><pre><span></span><code><span class="c1">#mount /dev/mapper/vgdata-lvtest /misc</span>

<span class="c1">#cp -a /boot/* /misc/</span>

<span class="c1">#umount /misc</span>

<span class="c1">#dump z9 -f /tmp/lvtest.dump /dev/mapper/vgdata-lvtest</span>
DUMP:<span class="w"> </span>Date<span class="w"> </span>of<span class="w"> </span>this<span class="w"> </span>level<span class="w"> </span>dump:<span class="w"> </span>Mon<span class="w"> </span>May<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">10</span>:34:31<span class="w"> </span><span class="m">2007</span>
DUMP:<span class="w"> </span>Dumping<span class="w"> </span>/dev/mapper/vgdata-lvtest<span class="w"> </span><span class="o">(</span>an<span class="w"> </span>unlisted<span class="w"> </span>file<span class="w"> </span>system<span class="o">)</span><span class="w"> </span>to<span class="w"> </span>/tmp/lvtest.dump
DUMP:<span class="w"> </span>Label:<span class="w"> </span>none
DUMP:<span class="w"> </span>Writing<span class="w"> </span><span class="m">10</span><span class="w"> </span>Kilobyte<span class="w"> </span>records
DUMP:<span class="w"> </span>Compressing<span class="w"> </span>output<span class="w"> </span>at<span class="w"> </span>compression<span class="w"> </span>level<span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="o">(</span>zlib<span class="o">)</span>
DUMP:<span class="w"> </span>mapping<span class="w"> </span><span class="o">(</span>Pass<span class="w"> </span>I<span class="o">)</span><span class="w"> </span><span class="o">[</span>regular<span class="w"> </span>files<span class="o">]</span>
DUMP:<span class="w"> </span>mapping<span class="w"> </span><span class="o">(</span>Pass<span class="w"> </span>II<span class="o">)</span><span class="w"> </span><span class="o">[</span>directories<span class="o">]</span>
DUMP:<span class="w"> </span>estimated<span class="w"> </span><span class="m">40454</span><span class="w"> </span>blocks.
DUMP:<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span><span class="w"> </span>started<span class="w"> </span>with<span class="w"> </span>block<span class="w"> </span><span class="m">1</span><span class="w"> </span>at:<span class="w"> </span>Mon<span class="w"> </span>May<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">10</span>:34:33<span class="w"> </span><span class="m">2007</span>
DUMP:<span class="w"> </span>dumping<span class="w"> </span><span class="o">(</span>Pass<span class="w"> </span>III<span class="o">)</span><span class="w"> </span><span class="o">[</span>directories<span class="o">]</span>
DUMP:<span class="w"> </span>dumping<span class="w"> </span><span class="o">(</span>Pass<span class="w"> </span>IV<span class="o">)</span><span class="w"> </span><span class="o">[</span>regular<span class="w"> </span>files<span class="o">]</span>
DUMP:<span class="w"> </span>Closing<span class="w"> </span>/tmp/lvtest.dump
DUMP:<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span><span class="w"> </span>completed<span class="w"> </span>at:<span class="w"> </span>Mon<span class="w"> </span>May<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">10</span>:34:44<span class="w"> </span><span class="m">2007</span>
DUMP:<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span><span class="w"> </span>took<span class="w"> </span><span class="m">0</span>:00:11
DUMP:<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span><span class="w"> </span>transfer<span class="w"> </span>rate:<span class="w"> </span><span class="m">3056</span><span class="w"> </span>kB/s
DUMP:<span class="w"> </span>Volume<span class="w"> </span><span class="m">1</span><span class="w"> </span>40530kB<span class="w"> </span>uncompressed,<span class="w"> </span>33626kB<span class="w"> </span>compressed,<span class="w"> </span><span class="m">1</span>.206:1
DUMP:<span class="w"> </span><span class="m">40530</span><span class="w"> </span>blocks<span class="w"> </span><span class="o">(</span><span class="m">39</span>.58MB<span class="o">)</span><span class="w"> </span>on<span class="w"> </span><span class="m">1</span><span class="w"> </span>volume<span class="o">(</span>s<span class="o">)</span>
DUMP:<span class="w"> </span>finished<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">11</span><span class="w"> </span>seconds,<span class="w"> </span>throughput<span class="w"> </span><span class="m">3684</span><span class="w"> </span>kBytes/sec
DUMP:<span class="w"> </span>Date<span class="w"> </span>of<span class="w"> </span>this<span class="w"> </span>level<span class="w"> </span>dump:<span class="w"> </span>Mon<span class="w"> </span>May<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">10</span>:34:31<span class="w"> </span><span class="m">2007</span>
DUMP:<span class="w"> </span>Date<span class="w"> </span>this<span class="w"> </span>dump<span class="w"> </span>completed:<span class="w"> </span>Mon<span class="w"> </span>May<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">10</span>:34:44<span class="w"> </span><span class="m">2007</span>
DUMP:<span class="w"> </span>Average<span class="w"> </span>transfer<span class="w"> </span>rate:<span class="w"> </span><span class="m">3056</span><span class="w"> </span>kB/s
DUMP:<span class="w"> </span>Wrote<span class="w"> </span>40530kB<span class="w"> </span>uncompressed,<span class="w"> </span>33626kB<span class="w"> </span>compressed,<span class="w"> </span><span class="m">1</span>.206:1
DUMP:<span class="w"> </span>DUMP<span class="w"> </span>IS<span class="w"> </span>DONE

<span class="c1"># ls -lh /tmp/lvtest.dump</span>
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span>33M<span class="w"> </span><span class="m">05</span>-21<span class="w"> </span><span class="m">10</span>:34<span class="w"> </span>/tmp/lvtest.dump

<span class="c1"># mkfs.ext3 /dev/mapper/vgdata-lvtest</span>
<span class="c1"># mount /dev/mapper/vgdata-lvtest /misc</span>
<span class="c1"># cd /misc</span>

<span class="c1"># restore rf /tmp/lvtest.dump</span>
Dump<span class="w"> </span>tape<span class="w"> </span>is<span class="w"> </span>compressed.
/dc50/sbin/restore:<span class="w"> </span>./lost+found:<span class="w"> </span>File<span class="w"> </span>exists
<span class="o">[</span>root@mlsx<span class="w"> </span>misc<span class="o">]</span><span class="c1"># ls</span>
boot.b<span class="w"> </span>initrd-2.6.18.3-52.img<span class="w"> </span>memtest86+-1.65<span class="w"> </span>System.map-2.6.18.3-52smp
vmlinuz-2.6.18.3-52smp
chain.b<span class="w"> </span>initrd-2.6.18.3-52smp.img<span class="w"> </span>message<span class="w"> </span>System.map-2.6.20.6-2
vmlinuz-2.6.20.6-2
config-2.6.18.3-52<span class="w"> </span>initrd-2.6.20.6-2.img<span class="w"> </span>module-info
System.map-2.6.20-ovz005.1<span class="w"> </span>vmlinuz-2.6.20-ovz005.1
config-2.6.18.3-52smp<span class="w"> </span>initrd-2.6.20-ovz005.1.img<span class="w"> </span>newinitrd.img
System.map-2.6.9-42.7AX<span class="w"> </span>vmlinuz-2.6.9-42.7AX
config-2.6.20.6-2<span class="w"> </span>initrd-2.6.9-42.7AX.img<span class="w"> </span>os2_d.b
vmlinux-2.6.20-ovz005.1
config-2.6.9-42.7AX<span class="w"> </span>initrd.img<span class="w"> </span>restoresymtable<span class="w"> </span>vmlinuz
grub<span class="w"> </span>lost+found<span class="w"> </span>System.map-2.6.18.3-52<span class="w"> </span>vmlinuz-2.6.18.3-52
</code></pre></div>
<p>从上面的例子来看，似乎 dump/restore 的使用方式和 tar 差不多，但是没有 tar 那么具有亲和力，毕竟 tar 是更加通俗的备份工具。
但是从技术角度来说，dump/restore 和 tar 存在质的区别：dump/restore 是基于块设备的备份方式，而 tar 则是同时文件系统。</p>
<p>这样的话，理论上dump 的速度应该比 tar 的速度要块写。而且因为是从块设备备份，因此也更灵活，提供的参数也特别多。</p>
<p>当时说到备份恢复，在 Unix 和 Linux 系统中，有太多的工具了。</p>
<p>除了这两者外，还有一些不太常见的，比如 cpio，这个文件格式在 Oracle 官方提供的介质下载中能看到，还有一个pax，Portable Archive eXchange 的缩写。</p>
<p>有关备份的工具，我找到一篇文档，大家可以看看</p>
<blockquote>
<p>Unix 系統基本的備份與回復工具—dump 及 restorerunuser: 用指定的账号或者组来运行一个 shell，类似 su 程序，但是他没有密码提示。上面的解释是 man 手册中的翻译，后面的哪个密码提示不怎么好理解，为什么呢？我们知道 su 程序从 root 账号切换到其他账号是不需要密码的，而普通账号之前的切换或者从普通账号切换到 root 账号，你需要提供密码的。 因为能从普通账号切换到 root 账号，因此意味着 su 命令是具有 setuid 的，而 runuser 却没有。所以当在 root 账号下执行 runuser test 是没有问题的，立刻切换到账号 test 环境下，但是这个时候你是无法从 test 账号切换切换到任何账号的，他会给你权限不够的提示。当然即便提供输入密码，也没戏，因为 runuser 是一个普通命令，没有 setuid 位，那就无法从普通账号切换了。所以我不清楚了有 su 这样的命令后，为什么还需要 runuser 这样的命令，历史原因？向后兼容？Unix 有？r 开头的其他命令这里不说了，有好几个是于 reiser 文件系统相关的命令，自从 reiser 文件系统的作者背叛谋杀妻子罪成立后，reiser 文件系统的命运就不好说了，据说作者准备出售 reiser 文件系统的版权来打官司。唉，还是等等看吧。另外就是 rmmod 命令，这是内核驱动卸载命令，我记得很早前的 rmmod 是 insmod 命令的一个软连接，现在不是了，看来他们分家了。但是分家的原因未知。rfmond 是 RedFlag 系统特有的，是红旗系统日志收集后台程序，前台是 GUI 界面的。rpc 开头的命令不少，这些命令更多的应该是被其他 rpc 应用程序来调用，比如 smb，比如 nfs。runlevel 比较熟悉，参数也仅有一个，它是从/var/run/utmp 文件中猜着当前运行的级别和之前运行的级别。比如你是在 3 级别登录的，然后执行 startx，然后你运行 runlevel，那么他给出的答案是 5 3 表示现在是 5 级别，之前是 3 级别。其实从 3 级别执行 startx 来启动图形级别，我更愿意说是在 3 级别启动了一个应用程序，这是这个应用程序比较特别，是一个 X-windows，从命令角度来说，他应该和在 3 级别执行 ls 等命令没有什么差别。所以我倒不希望 startx 后，运行 runlevel 给出是答案是 5 3,我期望是 3.这样 startx 这个命令本身就没有什么特别性了。我这里来说，是比较好向 Linux 新手解释 Linux 的 X-windows。我理解的从 3 级别到 5 级别应该采用最原始，最传统的 init 5 命令。</p>
</blockquote>
<h3 id="sfdisk">sfdisk<a class="headerlink" href="#sfdisk" title="Permanent link">&para;</a></h3>
<p>有四个主要的功能：列出一个分区的大小（块为单位），一个设备的所有分区，检查一个设备的分区表，重新分区一个设备。</p>
<p>其实我在平时用的最多的是第二个--列出一个设备的分区表。有了 fdisk 命令，为什么还要有 sfdisk 命令呢？我第一次具体使用 sfdisk 命令，还是在 HP DL 系列机器上。
HP 机器使用了 Smart Array 阵列卡，其链接的 SCSI 在 linux 中识别出来的不是平常我们常认为的 sdx 设备，而是 <code>cciss/c0d0px</code> 这样的样子。</p>
<p>而这样的分区信息，使用 fdisk -l 是没有办法打印出来的，这个时候就要使用<code>sfdisk -l</code>命令了。这就使用到了 sfdisk 的第二个功能了。</p>
<p>他的第三个功能和第四个没有使用过，不过刚才看 man 手册，发现其备份和恢复分区表的方式倒是很简单。</p>
<p>备份分区表：</p>
<div class="highlight"><pre><span></span><code>sfdisk<span class="w"> </span>/dev/hdd<span class="w"> </span>-O<span class="w"> </span>hdd-partition-sectors.save
</code></pre></div>
<p>恢复分区表：</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span>sfdisk<span class="w"> </span>/dev/hdd<span class="w"> </span>-I<span class="w"> </span>hdd-partition-sectors.save
</code></pre></div>
<p>下面是我的具体测试：</p>
<div class="highlight"><pre><span></span><code>fdisk<span class="w"> </span>-l<span class="w"> </span>/dev/mdp0
<span class="c1"># fdisk -l /dev/mdp0</span>

Disk<span class="w"> </span>/dev/mdp0:<span class="w"> </span><span class="m">419</span><span class="w"> </span>MB,<span class="w"> </span><span class="m">419299328</span><span class="w"> </span>bytes
<span class="m">2</span><span class="w"> </span>heads,<span class="w"> </span><span class="m">4</span><span class="w"> </span>sectors/track,<span class="w"> </span><span class="m">102368</span><span class="w"> </span>cylinders
<span class="nv">Units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cylinders<span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>*<span class="w"> </span><span class="nv">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4096</span><span class="w"> </span>bytes

Device<span class="w"> </span>Boot<span class="w"> </span>Start<span class="w"> </span>End<span class="w"> </span>Blocks<span class="w"> </span>Id<span class="w"> </span>System
/dev/mdp0p1<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">24415</span><span class="w"> </span><span class="m">97658</span><span class="w"> </span><span class="m">83</span><span class="w"> </span>Linux
/dev/mdp0p2<span class="w"> </span><span class="m">24416</span><span class="w"> </span><span class="m">102368</span><span class="w"> </span><span class="m">311812</span><span class="w"> </span><span class="m">83</span><span class="w"> </span>Linux
<span class="c1"># ls /misc</span>
boot.b
<span class="c1"># df</span>
文件系统<span class="w">        </span>1K-块<span class="w"> </span>已用<span class="w"> </span>可用<span class="w"> </span>已用%<span class="w"> </span>挂载点
/dev/mdp0p2<span class="w"> </span><span class="m">301959</span><span class="w"> </span><span class="m">50763</span><span class="w"> </span><span class="m">235606</span><span class="w"> </span><span class="m">18</span>%<span class="w"> </span>/misc

<span class="c1">#sfdisk /dev/mdp0 -O /tmp/mdp0-partition.save</span>

<span class="c1"># ls -l /tmp/mdp0-partition.save</span>
-r–r–r–<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">516</span><span class="w"> </span><span class="m">05</span>-28<span class="w"> </span><span class="m">00</span>:06<span class="w"> </span>/tmp/mdp0-partition.save

<span class="c1"># dd if=/dev/zero of=/dev/mdp0 bs=512 count=1</span>
<span class="m">1</span>+0<span class="w"> </span>records<span class="w"> </span><span class="k">in</span>
<span class="m">1</span>+0<span class="w"> </span>records<span class="w"> </span>out
<span class="m">512</span><span class="w"> </span>bytes<span class="w"> </span><span class="o">(</span><span class="m">512</span><span class="w"> </span>B<span class="o">)</span><span class="w"> </span>copied,<span class="w"> </span><span class="m">7</span>.9619e-05<span class="w"> </span>seconds,<span class="w"> </span><span class="m">6</span>.4<span class="w"> </span>MB/s

<span class="c1"># fdisk -l /dev/mdp0</span>

Disk<span class="w"> </span>/dev/mdp0:<span class="w"> </span><span class="m">419</span><span class="w"> </span>MB,<span class="w"> </span><span class="m">419299328</span><span class="w"> </span>bytes
<span class="m">2</span><span class="w"> </span>heads,<span class="w"> </span><span class="m">4</span><span class="w"> </span>sectors/track,<span class="w"> </span><span class="m">102368</span><span class="w"> </span>cylinders
<span class="nv">Units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cylinders<span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>*<span class="w"> </span><span class="nv">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4096</span><span class="w"> </span>bytes

Disk<span class="w"> </span>/dev/mdp0<span class="w"> </span>doesnt<span class="w"> </span>contain<span class="w"> </span>a<span class="w"> </span>valid<span class="w"> </span>partition<span class="w"> </span>table
<span class="c1"># sfdisk /dev/mdp0 -I /tmp/mdp0-partition.save</span>
Re-reading<span class="w"> </span>the<span class="w"> </span>partition<span class="w"> </span>table<span class="w"> </span>…
<span class="c1"># fdisk -l /dev/mdp0</span>

Disk<span class="w"> </span>/dev/mdp0:<span class="w"> </span><span class="m">419</span><span class="w"> </span>MB,<span class="w"> </span><span class="m">419299328</span><span class="w"> </span>bytes
<span class="m">2</span><span class="w"> </span>heads,<span class="w"> </span><span class="m">4</span><span class="w"> </span>sectors/track,<span class="w"> </span><span class="m">102368</span><span class="w"> </span>cylinders
<span class="nv">Units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cylinders<span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>*<span class="w"> </span><span class="nv">512</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4096</span><span class="w"> </span>bytes

Device<span class="w"> </span>Boot<span class="w"> </span>Start<span class="w"> </span>End<span class="w"> </span>Blocks<span class="w"> </span>Id<span class="w"> </span>System
/dev/mdp0p1<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">24415</span><span class="w"> </span><span class="m">97658</span><span class="w"> </span><span class="m">83</span><span class="w"> </span>Linux
/dev/mdp0p2<span class="w"> </span><span class="m">24416</span><span class="w"> </span><span class="m">102368</span><span class="w"> </span><span class="m">311812</span><span class="w"> </span><span class="m">83</span><span class="w"> </span>Linux

<span class="c1"># mount /dev/mdp0p2 /misc</span>
<span class="c1"># ls /misc</span>
boot.b
</code></pre></div>
<p>从上面的例子可以看出，sfdisk 确实可以做到分区的备份和恢复，而且分区已有数据并不会丢失。  </p>
<p>这其实和拿着一片原始钥匙去配钥匙的地方复制一片出来，某天原始的丢了，用这片复制的打开房门，房子的摆设当然什么都没有改变。</p>
<h3 id="sbin">/sbin 下剩余的命令<a class="headerlink" href="#sbin" title="Permanent link">&para;</a></h3>
<p>从 t 到 z 开头的命令不太多，而且很多也是常用的，也只有那些基本用法，因此我就不记录到这里。</p>
<h3 id="tune2fs">tune2fs<a class="headerlink" href="#tune2fs" title="Permanent link">&para;</a></h3>
<p>这无疑是文件系统中强劲的命令了，虽然我我最常用的是修改需要做 fsck 之前的最大挂载次数。刚看了 man 手册，其实他的参数多着呢，很多文件系统元数据都可以修改，比如保留块大小，日志大小，挂载选项等。</p>
<p>还发现一个<code>-L</code>的参数是给文件系统设置卷表，以前我都是用 e2lable 来干这个活的，没有想到 tune2fs 也能做。看来下次可以不用需要 e2label 了。</p>
<p><code>u</code> 开头的基本上都是和 udev 相关的，这方面，我贴过一个理解 udev 的文章，这里就不再贴了。</p>
<p><code>v</code> 开头有两个命令，vboxd，vchange，是和 ISDN 有关的，这应该算是一段历史吧。</p>
<p><code>w</code> 开头只有一个命令: wait_for_sysfs，是 udev 的 rpm 包里的，用在 udev 规则里。</p>
<p><code>x</code> 开头的与 xfs 文件系统有关的，可惜目前我发现在 DC 上 xfs 支持得并不是太好。</p>
<p><code>y</code> 开头只有一个命令：ypbind，是 NIS 的相关命令，这个从 Solaris 上迁移过来的东西，不知道有没有在 Linux 运行的案例。</p>
<p><code>z</code> 开头的就没有了。</p>
<h2 id="usrsbin">/usr/sbin 下的命令<a class="headerlink" href="#usrsbin" title="Permanent link">&para;</a></h2>
<p><code>/usr/sbin</code>下的命令明显比/sbin 下的命令多了很多，因此<code>/usr/sbin</code>应该是一个比较长的学习过程。</p>
<h3 id="alternatives">alternatives<a class="headerlink" href="#alternatives" title="Permanent link">&para;</a></h3>
<p>用来对系统中不同版本的同个软件进行管理的工具，比如系统里默认有多个 java 版本，到底使用那个版本的 java 程序，这时就需要 alternatives 来管理了。</p>
<p><code>etc/alternatives</code>目录就是它的大本营，里面全是链接文件。  </p>
<p>这个命令网上有很多帖子详细说明了用法，那我就使用拿来主义了<a href="http://www.linuxquestions.org/linux/answers/Applications_GUI_Multimedia/LINUX_ALTERNATIVES_HOWTO">LINUX alternatives howto</a>用一个实际的例子描述了 alternatives 的用法。</p>
<h3 id="am-eject">am-eject<a class="headerlink" href="#am-eject" title="Permanent link">&para;</a></h3>
<p>这是 am-utils 包的一个命令，am-utils 是一个 BSD 的 automount 程序，用来自动挂载一些文件系统。
从 <code>amd.conf</code> 的 man 手册来看，似乎 am-utils 自能自动挂载 NFS 的文件系统。
系统同时也带了 autofs 这个自动挂载程序，与 am-utils 不同的是，autofs 是内核级别的，它需要内核的支持，另外它支持各种文件系统的挂载。
而 am-utils 则是用户空间的，内核并不知道需要挂载哪些文件系统。分别有两篇文章详细描述了 autofs 和 am-utils 的用法，分别是
<a href="http://www.am-utils.org/docs/am-utils/am-utils.html">Am-utils (4.4BSD Automounter Utilities)</a>和
<a href="ftp://ftp.nrc.ca/pub/systems/linux/HOWTO/translations/zh/gb/mini/Automount.txt.gz">autofs-HOWTO</a>。</p>
<h3 id="anaconda">anaconda<a class="headerlink" href="#anaconda" title="Permanent link">&para;</a></h3>
<p>目前通用的 linux 系统安装向导程序，应该算是 python 的代表作吧。到网上搜索了一下，第一个找到的文章竟然是现在的同事柏生在 2005 年发表在 IBM 开发网站的文章，因此就直接拿过来了</p>
<p><a href="http://www.ibm.com/developerworks/cn/linux/l-anaconda/index.html">redhat 安装程序 anaconda分析</a>。</p>
<h3 id="anacron">anacron<a class="headerlink" href="#anacron" title="Permanent link">&para;</a></h3>
<p>anacron 是和 cron 相似的任务调度器，只不过它并不要求系统持续运行。它可以用来运行通常由 cron 运行的每日、每周、和每月的作业。</p>
<p>网上同样的详细的帖子介绍，<a href="http://knit.ntsky.com/docs/redhat9/rhl-cg-zh_CN-9/s1-autotasks-anacron.html">anacron</a></p>
<h3 id="bgpd">bgpd<a class="headerlink" href="#bgpd" title="Permanent link">&para;</a></h3>
<p><a href="http://www.qugga.net">Quagga</a>软件包的一个程序，用来实现 BGPv4 等路由协议的程序。
Quagga 是一个路由程序套件，它提供了 OSPFv2, OSPFv3, RIP v1 and v2, RIPng and BGP-4 等协议的实现。
用它，就可以把一个 Linux 系统改造成一个功能强大的路由器，和那些动则上十万百万的硬件路由器功能相当，对于 SMB(Small Middle Business)而言,应该是非常不错的选择。</p>
<p>Quagga 还包括下面一些命令：
<code>bgpd ospf6d ospfclient ospfd ripd ripngd watchquagga zebra</code></p>
<p>quagga 的使用方式和使用 cisco 等网络设备厂商的设备差不多，可惜我对这些产品一窍不通，因此 quagga 这么好用的软件，对我来说，也就用处不大了，于是略过。</p>
<h3 id="bmc-config">bmc-config<a class="headerlink" href="#bmc-config" title="Permanent link">&para;</a></h3>
<p>bmc-config, bmc-info IPMI BMC 配置工具程序，IPMI(Intelligent Platform Management Interface）即智能平台管理接口是使硬件管理具备“智能化”的新一代通用接口标准。</p>
<p>用户可以利用 IPMI监视服务器的物理特征，如温度、电压、电扇工作状态、电源供应以及机箱入侵等。Ipmi 最大的优势在于它是独立于 CPU BIOS 和 OS的，
所以用户无论在开机还是关机的状态下，只要接通电源就可以实现对服务器的监控。Ipmi 是一种规范的标准，其中最重要的物理部件就是 BMC(Baseboard Management Controller
如图 1)，一种嵌入式管理微控制器，它相当于整个平台管理的“大脑”，通过它 ipmi可以监控各个传感器的数据并记录各种事件的日志。
详细的情况可以参考 IBM 开发网的一篇文档--<a href="http://www.ibm.com/developerworks/cn/linux/l-ipmi/index.html">使用 ipmitool 实现 Linux系统下对服务器的 ipmi 管理</a>。</p>
<h3 id="brctl">brctl<a class="headerlink" href="#brctl" title="Permanent link">&para;</a></h3>
<p>网桥管理程序，用来设置，维护监控 linux 内核网桥配置信息。
说实在的我不太清楚网桥和 hub 之间到底有多少区别，所以也就不知道桥接是什么概念了
。于是我也没有从来没有使用过网桥的功能。<a href="http://h50069.www5.hp.com/e-Delivery3/Forum/WebUI/Messages/ShowTopic.aspx?RID=6f770c6e-d7ee-4bc8-bb83-8345064ce11d">这里有篇文档</a>详细说明了网桥的概念，用途，局限性。</p>
<p>文章提到网桥适合小型较简单的网络，那我直接用一个 HUB 就行了，100 块不到就搞定了。</p>
<h3 id="chroot">chroot<a class="headerlink" href="#chroot" title="Permanent link">&para;</a></h3>
<p>指定根文件系统（/），当我第一次使用这个命令的时候，我才发现 Linux 原来如此强大，仅仅只需要这样一个简单的命令，就可以同时使用已经存在的多个系统。
比如我平常使用的系统是 Everest，他适合桌面办公，但是我在出去培训和自己联系一些有关企业应用的时候，我需要 DC5 的环境，这个时候 chroot 就帮上我的大忙了，仅仅只需要把 DC5 的根文件系统挂载上来，然后 chroot 到这个挂载点，DC5 的环境就有了，大部分情况下，和直接使用 DC5 没有差别，只是这个系统系统使用还是 Everest 的核心，因此当需要执行与核心有关的命令的时候，此时 chroot 就有点无能为力了，不过好在这样的情况不太多。Chroot，很伟大的创造！</p>
<h3 id="chpasswd">chpasswd<a class="headerlink" href="#chpasswd" title="Permanent link">&para;</a></h3>
<p>批量修改密码，这对维护拥有大量用户账号的管理员而言，无疑有帮助，虽然作为一个系统管理员，可以很简单的写一个程序来达到批量修改账号密码的目的，但是既然系统提供了这样的功能，那我们为什么不直接使用呢？
他从标注输入读取每行用户信息，每行由 <code>username:password</code> 组成。
对于 password 的格式，chpasswd 程序给出贴心的一面，可以使用明文的方式，这样就免除了我们自己去生成密文的烦扰，同时日后也知道用户的初始密码是多少。
另外一个方面，如果你从完全考虑，希望这个文件里不要出现明文的密码，那么你可以使用加密的密码填充 password 这个字段，只是使用这个 chpasswd 命令的时候，需要使用 <code>-e</code> 的参数。  </p>
<div class="highlight"><pre><span></span><code><span class="c1"># cat /tmp/chpwd.txt</span>
work:test<span class="w"> </span>oracle:test
<span class="c1"># chpasswd  </span>
</code></pre></div>
<p>应该说是非常方便的。</p>
<h3 id="dhcrelay">dhcrelay<a class="headerlink" href="#dhcrelay" title="Permanent link">&para;</a></h3>
<p>DHCP 服务器中转器。当你的网络有两个 VLAN，但是只在 VLAN A 里放置了一个 DHCP 服务器，那么如何让 VLAN B 的机器也能自动获得 IP 地址呢，这个时候，
你需要 dhcrelay 了。这方面的文档，网络上比较多，给出两篇：  </p>
<ul>
<li><a href="http://www.homeweb.idv.tw/index.php?pl=249">DHCP relay agent</a>  </li>
<li><a href="http://linux.chinaunix.net/bbs/viewthread.php?action=printable&amp;tid=904010">dhcp server 可不可以跨网段来工作</a>。</li>
</ul>
<h3 id="dovecot">dovecot<a class="headerlink" href="#dovecot" title="Permanent link">&para;</a></h3>
<p>一个简单但是安全的 IMAP 服务器，也包括了 POP3 服务，支持 mbox 和 maildir 两种邮件存储格式。 
以前我还不知道系统自带了这么好的东西，也还简单。</p>
<h3 id="dump-acct">dump-acct<a class="headerlink" href="#dump-acct" title="Permanent link">&para;</a></h3>
<p>导出进程记账文件，默认是<code>/var/account/pacct</code>，他和 accton 命令是配合起来用的。</p>
<h3 id="dump-utmp">dump-utmp<a class="headerlink" href="#dump-utmp" title="Permanent link">&para;</a></h3>
<p>导出登录记账文件，默认是 <code>/var/log/wtmp</code>，其功能和 last 命令相似。</p>
<h3 id="dumpcap">dumpcap<a class="headerlink" href="#dumpcap" title="Permanent link">&para;</a></h3>
<p>dump 网络包，他抓获网络数据包并写入文件，文件格式可以是 libcap 的，也可以是 ethereal 的，当然也能是 tcpdump 的。
但是我不知道他和 tcpdump 有什么不同,Google 了一下，也没有发现什么，我觉得这不重要，Linux 下不是经常对某一个功能，有一打的命令可以实现吗？</p>
<p>man 手册给出了一个例子：</p>
<div class="highlight"><pre><span></span><code><span class="c1">#dumpcap -i eth1 -a duration:60 -w output.pcap</span>
</code></pre></div>
<p>表示抓取通过 eth1,60 秒内的数据包，并到文件<code>output.cap</code>。抓出的包内容大致如下：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cat output.pcap |more</span>
Accept:<span class="w"> </span>*/*
Accept-Language:<span class="w"> </span>en-us
User-Agent:<span class="w"> </span>MSMSGS
Host:<span class="w"> </span><span class="m">207</span>.46.106.77
Proxy-Connection:<span class="w"> </span>Keep-Alive
Connection:<span class="w"> </span>Keep-Alive
Pragma:<span class="w"> </span>no-cache
Content-Type:<span class="w"> </span>application/x-msn-messenger
Content-Length:<span class="w"> </span><span class="m">0</span>

0F�
<span class="m">2</span>^<span class="w"> </span>english<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">onclick</span><span class="o">=</span><span class="s2">&quot;return top.js.OpenExtLink(window,event,this)&quot;</span>&gt;
other
<span class="p">&amp;</span>nbsp<span class="p">;</span>
</code></pre></div>
<h3 id="filefrag">filefrag<a class="headerlink" href="#filefrag" title="Permanent link">&para;</a></h3>
<p>Linux 下的文件系统相比 Windows 的文件系统要优越，其中一点就是不用做磁盘碎片整理，但是这并不意味着 Linux 下的磁盘读写就不会产生碎片。</p>
<p>filefrag 这个命令就是用来报告一个文件是否有碎片的程序。看几个例子</p>
<div class="highlight"><pre><span></span><code><span class="c1"># filefrag /etc/passwd -v</span>
Checking<span class="w"> </span>/etc/passwd
Filesystem<span class="w"> </span><span class="nb">type</span><span class="w"> </span>is:<span class="w"> </span>ef53
Filesystem<span class="w"> </span>cylinder<span class="w"> </span>groups<span class="w"> </span>is<span class="w"> </span>approximately<span class="w"> </span><span class="m">848</span>
Blocksize<span class="w"> </span>of<span class="w"> </span>file<span class="w"> </span>/etc/passwd<span class="w"> </span>is<span class="w"> </span><span class="m">1024</span>
File<span class="w"> </span>size<span class="w"> </span>of<span class="w"> </span>/etc/passwd<span class="w"> </span>is<span class="w"> </span><span class="m">1534</span><span class="w"> </span><span class="o">(</span><span class="m">2</span><span class="w"> </span>blocks<span class="o">)</span>
First<span class="w"> </span>block:<span class="w"> </span><span class="m">4245865</span>
Last<span class="w"> </span>block:<span class="w"> </span><span class="m">4245866</span>
/etc/passwd:<span class="w"> </span><span class="m">1</span><span class="w"> </span>extent<span class="w"> </span>found

<span class="c1"># filefrag /data/tools/db2_v9.iso</span>
/data/tools/db2_v9.iso:<span class="w"> </span><span class="m">73</span><span class="w"> </span>extents<span class="w"> </span>found,<span class="w"> </span>perfection<span class="w"> </span>would<span class="w"> </span>be<span class="w"> </span><span class="m">3</span><span class="w"> </span>extents

<span class="c1"># filefrag /data/tools/db2_v9.iso -v</span>
Checking<span class="w"> </span>/data/tools/db2_v9.iso
Filesystem<span class="w"> </span><span class="nb">type</span><span class="w"> </span>is:<span class="w"> </span>ef53
Filesystem<span class="w"> </span>cylinder<span class="w"> </span>groups<span class="w"> </span>is<span class="w"> </span>approximately<span class="w"> </span><span class="m">245</span>
Blocksize<span class="w"> </span>of<span class="w"> </span>file<span class="w"> </span>/data/tools/db2_v9.iso<span class="w"> </span>is<span class="w"> </span><span class="m">4096</span>
File<span class="w"> </span>size<span class="w"> </span>of<span class="w"> </span>/data/tools/db2_v9.iso<span class="w"> </span>is<span class="w"> </span><span class="m">330647552</span><span class="w"> </span><span class="o">(</span><span class="m">80725</span><span class="w"> </span>blocks<span class="o">)</span>
First<span class="w"> </span>block:<span class="w"> </span><span class="m">3851518</span>
Last<span class="w"> </span>block:<span class="w"> </span><span class="m">3954148</span>
Discontinuity:<span class="w"> </span>Block<span class="w"> </span><span class="m">769</span><span class="w"> </span>is<span class="w"> </span>at<span class="w"> </span><span class="m">3852400</span><span class="w"> </span><span class="o">(</span>was<span class="w"> </span><span class="m">3852287</span><span class="o">)</span>
Discontinuity:<span class="w"> </span>Block<span class="w"> </span><span class="m">811</span><span class="w"> </span>is<span class="w"> </span>at<span class="w"> </span><span class="m">3852471</span><span class="w"> </span><span class="o">(</span>was<span class="w"> </span><span class="m">3852441</span><span class="o">)</span>
Discontinuity:<span class="w"> </span>Block<span class="w"> </span><span class="m">844</span><span class="w"> </span>is<span class="w"> </span>at<span class="w"> </span><span class="m">3852560</span><span class="w"> </span><span class="o">(</span>was<span class="w"> </span><span class="m">3852503</span><span class="o">)</span>
Discontinuity:<span class="w"> </span>Block<span class="w"> </span><span class="m">2617</span><span class="w"> </span>is<span class="w"> </span>at<span class="w"> </span><span class="m">3854368</span><span class="w"> </span><span class="o">(</span>was<span class="w"> </span><span class="m">3854335</span><span class="o">)</span>
Discontinuity:<span class="w"> </span>Block<span class="w"> </span><span class="m">2636</span><span class="w"> </span>is<span class="w"> </span>at<span class="w"> </span><span class="m">3854528</span><span class="w"> </span><span class="o">(</span>was<span class="w"> </span><span class="m">3854386</span><span class="o">)</span>
Discontinuity:<span class="w"> </span>Block<span class="w"> </span><span class="m">2662</span><span class="w"> </span>is<span class="w"> </span>at<span class="w"> </span><span class="m">3854610</span><span class="w"> </span><span class="o">(</span>was<span class="w"> </span><span class="m">3854553</span><span class="o">)</span>
......
/data/tools/db2_v9.iso:<span class="w"> </span><span class="m">73</span><span class="w"> </span>extents<span class="w"> </span>found,<span class="w"> </span>perfection<span class="w"> </span>would<span class="w"> </span>be<span class="w"> </span><span class="m">3</span><span class="w"> </span>extents
</code></pre></div>
<p>第一个文件<code>/etc/passwd</code>没有产生碎片，但是第二个文件就不同了，一共有 73 个不连贯的地方（输出省略了一些）。  </p>
<p>既然有显示磁盘碎片的程序，那我就想是否有整理磁盘碎片的程序呢，到网上搜索了一下，有人说系统上有 defrag 命令，但是我的系统显然没有。</p>
<p>还有人说，Linux 根本用不着做磁盘碎片整理。是啊，记得第一次解除 Linux 的时候，就看到有这样的话--Linux 不需要磁盘整理--不过如果你真的想解决这个其实不是问题的问题，那你可以尝试 fsck，
网上说这样可以减少文件带来的磁盘碎片，但是我现在没有做这个测试。等有机会应该试试。</p>
<p>这个命令的最后输出“perfection would be 3 extents”没有太明白他的意思，是不是说如果我采用某个方式，就可以把这些磁盘碎片的个数由 73 个降低到 3 个呢？用什么样的方法呢？没有找到。</p>
<h3 id="wireshark">wireshark<a class="headerlink" href="#wireshark" title="Permanent link">&para;</a></h3>
<p><a href="http://www.wireshark.org/">wireshark</a>：乍一看，不知道这个命令做什么用的，man 了一下手册，到网络上搜寻了一把，才知道原来它是大名鼎鼎的 Ethereal 的化身呀，ethereal 估计很多用过 Linux 的人都知道，它是世界上最流行的网络分析工具之一，这个强大的工具可以捕捉网络中的数据，并未用户提供网络和上层协议的各种信息，它具有安装简便，简单易用，功能丰富等特征。</p>
<p>值得一提的是，它还有一个非常容易操作的图形界面，当然如果你是 CLI 的死忠分析，也许 tshark 会成为你的最爱，tshark 是 wireshark 的 CLI 实现。</p>
<h3 id="tripwire">tripwire<a class="headerlink" href="#tripwire" title="Permanent link">&para;</a></h3>
<p><a href="http://www.tripwire.org">tripwire</a>：<code>*nix</code> 系统下最著名的文件系统完整性检查工具，这个软件采取的核心技术就是对每个要监控的文件产生一个数字签名并保留下来。</p>
<p>当数字签名不一致时，必定文件被修改过。当你要为你的系统安全着想的时候，你应该想起它！</p>
<h3 id="vipw">vipw<a class="headerlink" href="#vipw" title="Permanent link">&para;</a></h3>
<p>不是多么神奇和高深的命令，不带任何参数，运行后，直接打开 <code>/etc/passwd</code>，于是我知道这个命令的意思了<code>vipw = vi /etc/passwd</code>，以为是一个脚本，然后 vipw 是一个地地道道的 ELF 文件，实际上他是 VIM 的 tiny 版的实现。<br />
不晓得作者写这个程序的目的是什么？仅仅是为了方便编辑<code>/etc/passwd</code>？还是说万一系统没有安装编辑器，我还用它当做编辑器用，  </p>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; wgzhao
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/01mlsx" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/wgzhao" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.indexes", "navigation.expand", "content.code.annotate", "content.tabs.link", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "header.autohide", "announce.dismiss", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5090c770.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/rod2ik/cdn@main/mkdocs/javascripts/mkdocs-graphviz.js"></script>
      
    
  </body>
</html>